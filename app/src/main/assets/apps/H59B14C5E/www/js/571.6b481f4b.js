"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[571],{3571:function(e,o,t){t.r(o),t.d(o,{default:function(){return u}});var s=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"page-login"},[t("van-form",{on:{submit:e.onSubmit}},[t("van-field",{attrs:{autocomplete:e.$root.getHash(),placeholder:"手机号","left-icon":"phone",type:"tel",maxlength:"11"},model:{value:e.form.phoneNumber,callback:function(o){e.$set(e.form,"phoneNumber",o)},expression:"form.phoneNumber"}}),t("van-field",{attrs:{autocomplete:e.$root.getHash(),placeholder:"密码","left-icon":"lock",type:e.showPassword?"text":"password","right-icon":e.showPassword?"eye-o":"closed-eye"},on:{"click-right-icon":function(o){e.showPassword=!e.showPassword}},model:{value:e.form.password,callback:function(o){e.$set(e.form,"password",o)},expression:"form.password"}}),t("van-field",{attrs:{autocomplete:e.$root.getHash(),placeholder:"验证码","left-icon":"youzan-shield"},scopedSlots:e._u([{key:"extra",fn:function(){return[t("van-image",{staticClass:"verifyCode",attrs:{src:e.verifyImageBase64},on:{click:e.refreshImageVerifyCode}})]},proxy:!0}]),model:{value:e.form.imgCode,callback:function(o){e.$set(e.form,"imgCode",o)},expression:"form.imgCode"}}),e.unbind?t("van-field",{attrs:{autocomplete:e.$root.getHash(),placeholder:"短信验证码","left-icon":"youzan-shield"},scopedSlots:e._u([{key:"extra",fn:function(){return[t("van-button",{staticClass:"btnGetVerifyCode primary",attrs:{size:"small","native-type":"button"},on:{click:e.getSmsVerifyCode}},[e.smsCountdown?t("van-count-down",{attrs:{time:e.smsCountdown,format:"SS","auto-start":""}}):[e._v(" 获取验证码 ")]],2)]},proxy:!0}],null,!1,1981831280),model:{value:e.form.smsCode,callback:function(o){e.$set(e.form,"smsCode",o)},expression:"form.smsCode"}}):e._e(),e.unbind?[t("van-button",{staticClass:"primary block unbind"},[e._v(" 确认登陆 ")])]:[t("div",{staticClass:"ver"},[e._v("版本号：V "+e._s(e.$root.version))]),t("van-button",{staticClass:"primary block"},[e._v(" 登录 ")]),t("div",{staticClass:"forgotPassword",on:{click:e.onForgotPsw}},[e._v("忘记密码？")])]],2)],1)},r=[],n=t(3652),i=t(9248),a=t(1922),d={data(){return{form:{phoneNumber:"",password:"",imgCode:"",phoneNumber:""},verifyImageBase64:"",showPassword:!1,smsCountdown:0,verifyUniqid:""}},computed:{unbind(){return 1==this.$route.query.unbind}},created(){this.refreshImageVerifyCode()},methods:{onSubmit(){return/^1[345789]\d{9}$/.test(this.form.phoneNumber)?!/^(?![^a-zA-Z]+$)(?!\D+$)/.test(this.form.password)||this.form.password.length<6||this.form.password.length>15?this.$toast.fail("请输入6-15位字母数字组成的密码"):void(0,n.x4)({phoneNumber:this.form.phoneNumber,password:this.form.password,code:this.form.imgCode,verifyUniqid:this.verifyUniqid}).then((({ok:e,data:o,msg:t})=>{e?(this.$root.userInfo=o.userInfo,this.$st.set("USER_INFO",o.userInfo),this.$st.set("TOKEN",o.token),(0,a.Ks)(o.token),this.$root.loadConfig(),this.$root.loadBanks(),this.$router.replace("/")):(this.refreshImageVerifyCode(),this.form.imgCode="",this.$toast.fail(t))})):this.$toast.fail("请输入合法的手机号码")},refreshImageVerifyCode(){(0,i.mg)({codeType:"login"}).then((({ok:e,data:o,code:t})=>{if(e)this.verifyUniqid=o.verifyUniqid,this.verifyImageBase64=o.verifyCode;else if(400==t)return this.$toast.fail("请输入合法的手机号码")}))},smsCount(){const e=this.$st.get("LAST_SMS_REQUEST");if(e){const o=Date.now()-Number(e);o<60&&(this.smsCountdown=1e3*(60-o))}},getSmsVerifyCode(){this.smsCountdown||(0,i.Z3)({phoneNumber:this.form.phoneNumber,codeType:"register"}).then((({ok:e,msg:o,data:t})=>{e?(this.$toast.success(o),this.smsCountdown=6e4,this.$st.set("LAST_SMS_REQUEST",Date.now())):this.$toast.fail(o)}))},onForgotPsw(){this.$dialog.confirm({className:"retrievePsw",message:"找回密码,请联系客服",confirmButtonColor:"#6f59fe",confirmButtonText:"确认",cancelButtonText:"取消",beforeClose:(e,o)=>{"confirm"===e&&this.$root.openCustomerService(),o()}})}}},m=d,f=t(1001),l=(0,f.Z)(m,s,r,!1,null,null,null),u=l.exports},9248:function(e,o,t){t.d(o,{Z3:function(){return i},mg:function(){return r},pw:function(){return n}});var s=t(1922);const r=e=>(0,s.q)({url:"/Api/Common/VerifyCode/getImageCode",method:"POST",data:e}),n=e=>(0,s.q)({url:"/Api/Common/VerifyCode/checkVerifyCode",method:"POST",data:e}),i=e=>(0,s.q)({url:"/Api/Common/VerifyCode/sendCode",method:"POST",data:e})}}]);