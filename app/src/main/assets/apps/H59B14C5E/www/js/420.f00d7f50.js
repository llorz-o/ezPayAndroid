"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[420],{46420:function(t,e,r){r.r(e),r.d(e,{default:function(){return w}});var n,o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"page bind-google-auth"},[1===t.step?[r("div",{staticClass:"tips"},[t._v(" 使用Google Authenticator扫码或输入设置密钥以绑定 ")]),r("van-image",{attrs:{id:"qrcode",src:t.authInfo.qrCodeUrl},scopedSlots:t._u([{key:"loading",fn:function(){return[r("van-loading",{attrs:{type:"spinner",size:"20"}})]},proxy:!0},{key:"error",fn:function(){return[r("van-icon",{attrs:{name:"qr-invalid"}})]},proxy:!0}],null,!1,3262582198)}),r("div",{staticClass:"copyWrapper"},[r("span",{staticClass:"key"},[t._v(t._s(t.authInfo.secret))]),r("button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:t.authInfo.secret,expression:"authInfo.secret"}],staticClass:"icon copy copyBtn",on:{success:t.$root.copySuccessful}})]),r("van-button",{staticClass:"block primary next",on:{click:function(e){t.step=2}}},[t._v(" 扫码或添加密钥完成 ")]),r("div",{staticClass:"guide danger_text"},[t._v(" 如何下载、绑定谷歌身份验证器？ ")])]:[r("div",{staticClass:"tips"},[t._v(" 输入动态验证码以验证身份 ")]),r("van-password-input",{attrs:{value:t.password,focused:t.showKeyboard},on:{focus:function(e){t.showKeyboard=!0}}}),r("van-number-keyboard",{attrs:{show:t.showKeyboard},on:{blur:function(e){t.showKeyboard=!1}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),r("div",{staticClass:"guide danger_text step2"},[t._v(" 绑定后，使用钱包充值游戏平台，卖币确认转币 需要通过谷歌身份验证器验证 ")]),r("van-button",{staticClass:"block primary",on:{click:t.checkBindGoogleAuthenticator}},[t._v(" 验证 ")]),r("van-button",{staticClass:"block secondary",on:{click:function(e){t.step=1}}},[t._v(" 取消 ")])]],2)},a=[],s=r(4367),c=r(16198),u=r(23796),i=(r(78975),r(68309),r(34158)),l=r(40378),f=r(13652),p=r(35962),d={components:(n={},(0,u.Z)(n,i.Z.name,i.Z),(0,u.Z)(n,l.Z.name,l.Z),n),data:function(){return{step:1,password:"",showKeyboard:!1,authInfo:{qrCodeUrl:"",secret:""}}},watch:{password:function(t){6===t.length&&(this.showKeyboard=!1)}},created:function(){this.$root.$emit("root:set-topbar",[])},methods:{bindGoogleAuthenticator:function(t){var e=this;return(0,c.Z)(regeneratorRuntime.mark((function r(){var n,o,a,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,(0,f.p$)({securePassword:t});case 2:n=r.sent,o=n.ok,a=n.data,c=n.msg,o?(e.authInfo=(0,s.Z)({},a||{}),e.$toast.success(c)):(e.$toast.fail(c),e.$router.back());case 7:case"end":return r.stop()}}),r)})))()},checkBindGoogleAuthenticator:function(){var t=this;return(0,c.Z)(regeneratorRuntime.mark((function e(){var r,n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(6===t.password.length){e.next=2;break}return e.abrupt("return",t.$toast.fail("请输入google验证码"));case 2:return e.next=4,(0,f.t4)({safeCode:t.password,secret:t.authInfo.secret});case 4:if(r=e.sent,n=r.ok,o=r.msg,!n){e.next=14;break}return t.$toast.success(o),e.next=11,t.$root.fetchUserInfo();case 11:t.$router.back(),e.next=15;break;case 14:t.$toast.fail(o);case 15:case"end":return e.stop()}}),e)})))()}},beforeRouteEnter:function(t,e,r){r((function(t){t.$dialog({className:"common",title:"请输入资金密码",message:"为了您的账户安全，绑定谷歌验证器需要验证资金密码",confirmButtonText:"确认",beforeClose:function(){var e=(0,c.Z)(regeneratorRuntime.mark((function e(r,n){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n(),e.next=3,(0,p.x)(t);case 3:if(o=e.sent,!o||6!==o.length){e.next=10;break}return t.$root.$emit("root:set-topbar",["left-back"]),e.next=8,t.bindGoogleAuthenticator(o);case 8:e.next=11;break;case 10:setTimeout((function(){return t.$router.back()}),350);case 11:case"end":return e.stop()}}),e)})));function r(t,r){return e.apply(this,arguments)}return r}()})}))}},h=d,v=r(1001),b=(0,v.Z)(h,o,a,!1,null,null,null),w=b.exports},35962:function(t,e,r){r.d(e,{D:function(){return s},x:function(){return a}});var n=r(16198),o=(r(78975),r(41539),r(13652)),a=function(t){return t.$toast("请输入资金密码"),new Promise((function(e,r){t.$root.showPassowordKeyboard=!0,t.$root.$once("root:global-password",function(){var t=(0,n.Z)(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",e(r));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))},s=function(t){return t.$root.userInfo&&t.$root.userInfo.isGoogleAuthenticator?(t.$toast("请输入Google安全码"),new Promise((function(e,r){setTimeout((function(){t.$root.showPassowordKeyboard=!0,t.$root.$once("root:global-password",function(){var r=(0,n.Z)(regeneratorRuntime.mark((function r(n){var a,s,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n){r.next=2;break}return r.abrupt("return",e(!1));case 2:return r.next=4,(0,o.Wg)({safeCode:n});case 4:a=r.sent,s=a.ok,c=a.msg,s?e(!0):(e(!1),t.$toast.fail(c));case 8:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}())}),0)}))):Promise.resolve(!0)}}}]);