"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[920],{41920:function(o,e,t){t.r(e),t.d(e,{default:function(){return l}});var s=function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("div",{staticClass:"page-login"},[t("van-form",{on:{submit:o.onSubmit}},[t("van-field",{attrs:{autocomplete:"new-password",placeholder:"手机号","left-icon":"phone",type:"tel",maxlength:"11"},model:{value:o.form.phoneNumber,callback:function(e){o.$set(o.form,"phoneNumber",e)},expression:"form.phoneNumber"}}),o.passwordModeSignIn?t("van-field",{attrs:{autocomplete:"new-password",placeholder:"密码","left-icon":"lock",type:o.showPassword?"text":"password","right-icon":o.showPassword?"eye-o":"closed-eye"},on:{"click-right-icon":function(e){o.showPassword=!o.showPassword}},model:{value:o.form.password,callback:function(e){o.$set(o.form,"password",e)},expression:"form.password"}}):o._e(),o.passwordModeSignIn?[1==o.$root.verifyCodeType?t("van-field",{attrs:{autocomplete:"new-password",placeholder:"验证码","left-icon":"youzan-shield"},scopedSlots:o._u([{key:"extra",fn:function(){return[t("van-image",{staticClass:"verifyCode",attrs:{src:o.verifyImageBase64},on:{click:o.refreshImageVerifyCode}})]},proxy:!0}],null,!1,2715648759),model:{value:o.form.imgCode,callback:function(e){o.$set(o.form,"imgCode",e)},expression:"form.imgCode"}}):o._e()]:o._e(),o.unbind||o.smsModeSignIn?t("van-field",{attrs:{autocomplete:"new-password",placeholder:"短信验证码","left-icon":"youzan-shield"},scopedSlots:o._u([{key:"extra",fn:function(){return[t("van-button",{staticClass:"btnGetVerifyCode primary",attrs:{size:"small","native-type":"button"},on:{click:o.getSmsVerifyCode}},[o.smsCountdown?t("van-count-down",{attrs:{time:o.smsCountdown,format:"ss","auto-start":""},on:{finish:function(e){o.smsCountdown=0}}}):[o._v(" 获取验证码 ")]],2)]},proxy:!0}],null,!1,1597490900),model:{value:o.form.smsCode,callback:function(e){o.$set(o.form,"smsCode",e)},expression:"form.smsCode"}}):o._e(),2==o.$root.verifyCodeType?t("div",{staticStyle:{display:"flex","justify-content":"center"}},[t("div",{ref:"dx"})]):o._e(),o.unbind?[t("van-button",{staticClass:"primary block unbind"},[o._v(" 确认登陆 ")])]:[t("div",{staticClass:"ver"},[t("span",{staticStyle:{"text-align":"left"}},[o._v(" 版本号：V "+o._s(o.$root.version)+" ")]),t("span",{staticStyle:{"text-align":"right"},on:{click:o.onForgotPsw}},[o._v(" 忘记密码？ ")])]),t("van-button",{staticClass:"primary block"},[o._v(" 登录 ")]),t("van-divider",{staticStyle:{color:"#6f5bfeff"}},[o._v("or")]),t("van-button",{staticClass:"block",attrs:{"native-type":"button",plain:"",color:"#6f5bfeff"},on:{click:function(e){o.mode=1==o.mode?2:1}}},[o._v(" "+o._s(o.modeSwitchButtonContext)+" ")])]],2)],1)},n=[],r=(t(74916),t(77601),t(15306),t(9653),t(13652)),i=t(19248),a=t(51922),f={data:function(){return{form:{phoneNumber:"",password:"",imgCode:"",smsCode:"",verifyToken:""},verifyImageBase64:"",showPassword:!1,smsCountdown:0,verifyUniqid:"",mode:1}},computed:{unbind:function(){return 1==this.$route.query.unbind},passwordModeSignIn:function(){return 1===this.mode},smsModeSignIn:function(){return 1!==this.mode},modeSwitchButtonContext:function(){return 1===this.mode?"短信验证码登录":2===this.mode?"密码登录":void 0}},created:function(){this.refreshImageVerifyCode()},methods:{onSubmit:function(){var o=this;return/^1[3456789]\d{9}$/.test(this.form.phoneNumber)?(!/^(?![^a-zA-Z]+$)(?!\D+$)/.test(this.form.password)||this.form.password.length<6||this.form.password.length>15)&&!this.smsModeSignIn?this.$toast.fail("请输入6-15位字母数字组成的密码"):2!=this.$root.verifyCodeType||this.form.verifyToken?this.unbind?""==this.form.smsCode?this.$toast.fail("请输入短信验证码"):void(0,r.rd)({phoneNumber:this.form.phoneNumber,password:this.form.password,code:this.form.imgCode,verifyUniqid:this.verifyUniqid,smsCode:this.form.smsCode,verifyToken:this.form.verifyToken}).then((function(e){var t=e.ok,s=e.data,n=e.msg;t?(o.$root.userInfo=s.userInfo,o.$st.set("USER_INFO",s.userInfo),o.$st.set("TOKEN",s.token),(0,a.Ks)(s.token),o.$root.refreshGlobalNotices(),o.$root.loadConfig(),o.$root.loadBanks(),o.$router.replace("/")):(o.refreshImageVerifyCode(),o.dx&&o.dx.reload(),o.form.verifyToken="",o.form.smsCode="",o.form.imgCode="",o.$toast.fail(n))})):this.smsModeSignIn?""==this.form.smsCode?this.$toast.fail("请输入短信验证码"):void(0,r.uL)({phoneNumber:this.form.phoneNumber,smsCode:this.form.smsCode,verifyToken:this.form.verifyToken}).then((function(e){var t=e.ok,s=e.data,n=e.msg,r=e.code;if(1001===r)return o.$router.push("/qr_login");t?(o.$root.userInfo=s.userInfo,o.$st.set("USER_INFO",s.userInfo),o.$st.set("TOKEN",s.token),(0,a.Ks)(s.token),o.$root.refreshGlobalNotices(),o.$root.loadConfig(),o.$root.loadBanks(),o.$root.loadPayments(),o.$router.replace("/")):(o.dx&&o.dx.reload(),o.form.verifyToken="",o.form.smsCode="",o.$toast.fail(n))})):void(0,r.x4)({phoneNumber:this.form.phoneNumber,password:this.form.password,code:this.form.imgCode,verifyUniqid:this.verifyUniqid,verifyToken:this.form.verifyToken}).then((function(e){var t=e.ok,s=e.data,n=e.msg,r=e.code;if(1001===r)return o.$router.push("/qr_login");t?(o.$root.userInfo=s.userInfo,o.$st.set("USER_INFO",s.userInfo),o.$st.set("TOKEN",s.token),(0,a.Ks)(s.token),o.$root.refreshGlobalNotices(),o.$root.loadConfig(),o.$root.loadBanks(),o.$root.loadPayments(),o.$router.replace("/")):(o.refreshImageVerifyCode(),o.dx&&o.dx.reload(),o.form.verifyToken="",o.form.imgCode="",o.$toast.fail(n))})):this.$toast.fail("请滑动验证"):this.$toast.fail("请输入合法的手机号码")},refreshImageVerifyCode:function(){var o=this;(0,i.mg)({codeType:"login"}).then((function(e){var t=e.ok,s=e.data,n=e.code;if(t)o.verifyUniqid=s.verifyUniqid,o.verifyImageBase64=s.verifyCode;else if(400==n)return o.$toast.fail("请输入合法的手机号码")}))},smsCount:function(){var o=this.$st.get("LAST_SMS_REQUEST");if(o){var e=Date.now()-Number(o);e<60&&(this.smsCountdown=1e3*(60-e))}},getSmsVerifyCode:function(){var o=this;this.smsCountdown||(0,i.Z3)({phoneNumber:this.form.phoneNumber,codeType:"login"}).then((function(e){var t=e.ok,s=e.msg;e.data;t?(o.$toast.success(s),o.smsCountdown=6e4,o.$st.set("LAST_SMS_REQUEST",Date.now())):o.$toast.fail(s)}))},onForgotPsw:function(){var o=this;this.$dialog.confirm({className:"retrievePsw",message:"找回密码,请联系客服",confirmButtonColor:"#6f59fe",confirmButtonText:"确认",cancelButtonText:"取消",beforeClose:function(e,t){"confirm"===e&&o.$root.openCustomerService(),t()}})}},mounted:function(){var o=this,e=this.$refs.dx;e&&(this.dx=_dx.Captcha(e,{appId:"ff5d9ebfae73ebe5d524d6414abf66de",apiServer:"http://cap-api.dingxiang-inc.com",style:"inline",success:function(e){o.form.verifyToken=e},fail:function(e){o.form.verifyToken=""}}))}},d=f,m=t(1001),u=(0,m.Z)(d,s,n,!1,null,null,null),l=u.exports},19248:function(o,e,t){t.d(e,{Z3:function(){return i},_B:function(){return a},mg:function(){return n},pw:function(){return r}});var s=t(51922),n=function(o){return(0,s.q)({url:"/Api/Common/VerifyCode/getImageCode",method:"POST",data:o})},r=function(o){return(0,s.q)({url:"/Api/Common/VerifyCode/checkVerifyCode",method:"POST",data:o})},i=function(o){return(0,s.q)({url:"/Api/Common/VerifyCode/sendCode",method:"POST",data:o})},a=function(o){return(0,s.q)({url:"/Api/User/UploadFile/uploadBase64Img",method:"POST",data:o})}}}]);