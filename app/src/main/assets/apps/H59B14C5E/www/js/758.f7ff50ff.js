"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[758],{10758:function(o,e,t){t.r(e),t.d(e,{default:function(){return l}});var s=function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("div",{staticClass:"page-login"},[t("van-form",{on:{submit:o.onSubmit}},[t("van-field",{attrs:{autocomplete:o.$root.getHash(),placeholder:"手机号","left-icon":"phone",type:"tel",maxlength:"11"},model:{value:o.form.phoneNumber,callback:function(e){o.$set(o.form,"phoneNumber",e)},expression:"form.phoneNumber"}}),t("van-field",{attrs:{autocomplete:o.$root.getHash(),placeholder:"密码","left-icon":"lock",type:o.showPassword?"text":"password","right-icon":o.showPassword?"eye-o":"closed-eye"},on:{"click-right-icon":function(e){o.showPassword=!o.showPassword}},model:{value:o.form.password,callback:function(e){o.$set(o.form,"password",e)},expression:"form.password"}}),t("van-field",{attrs:{autocomplete:o.$root.getHash(),placeholder:"验证码","left-icon":"youzan-shield"},scopedSlots:o._u([{key:"extra",fn:function(){return[t("van-image",{staticClass:"verifyCode",attrs:{src:o.verifyImageBase64},on:{click:o.refreshImageVerifyCode}})]},proxy:!0}]),model:{value:o.form.imgCode,callback:function(e){o.$set(o.form,"imgCode",e)},expression:"form.imgCode"}}),o.unbind?t("van-field",{attrs:{autocomplete:o.$root.getHash(),placeholder:"短信验证码","left-icon":"youzan-shield"},scopedSlots:o._u([{key:"extra",fn:function(){return[t("van-button",{staticClass:"btnGetVerifyCode primary",attrs:{size:"small","native-type":"button"},on:{click:o.getSmsVerifyCode}},[o.smsCountdown?t("van-count-down",{attrs:{time:o.smsCountdown,format:"SS","auto-start":""},on:{finish:function(e){o.smsCountdown=0}}}):[o._v(" 获取验证码 ")]],2)]},proxy:!0}],null,!1,1500168340),model:{value:o.form.smsCode,callback:function(e){o.$set(o.form,"smsCode",e)},expression:"form.smsCode"}}):o._e(),o.unbind?[t("van-button",{staticClass:"primary block unbind"},[o._v(" 确认登陆 ")])]:[t("div",{staticClass:"ver"},[o._v("版本号：V "+o._s(o.$root.version))]),t("van-button",{staticClass:"primary block"},[o._v(" 登录 ")]),t("div",{staticClass:"forgotPassword",on:{click:o.onForgotPsw}},[o._v("忘记密码？")])]],2)],1)},r=[],n=t(23796),i=(t(74916),t(77601),t(15306),t(9653),t(13652)),a=t(19248),f=t(51922),u={data:function(){return{form:(0,n.Z)({phoneNumber:"",password:"",imgCode:""},"phoneNumber",""),verifyImageBase64:"",showPassword:!1,smsCountdown:0,verifyUniqid:""}},computed:{unbind:function(){return 1==this.$route.query.unbind}},created:function(){this.refreshImageVerifyCode()},methods:{onSubmit:function(){var o=this;return/^1[345789]\d{9}$/.test(this.form.phoneNumber)?!/^(?![^a-zA-Z]+$)(?!\D+$)/.test(this.form.password)||this.form.password.length<6||this.form.password.length>15?this.$toast.fail("请输入6-15位字母数字组成的密码"):this.unbind?""==this.form.smsCode?this.$toast.fail("请输入短信验证码"):void(0,i.rd)({phoneNumber:this.form.phoneNumber,password:this.form.password,code:this.form.imgCode,verifyUniqid:this.verifyUniqid,smsCode:this.form.smsCode}).then((function(e){var t=e.ok,s=e.data,r=e.msg;t?(o.$root.userInfo=s.userInfo,o.$st.set("USER_INFO",s.userInfo),o.$st.set("TOKEN",s.token),(0,f.Ks)(s.token),o.$root.refreshGlobalNotices(),o.$root.loadConfig(),o.$root.loadBanks(),o.$router.replace("/")):(o.refreshImageVerifyCode(),o.form.smsCode="",o.form.imgCode="",o.$toast.fail(r))})):void(0,i.x4)({phoneNumber:this.form.phoneNumber,password:this.form.password,code:this.form.imgCode,verifyUniqid:this.verifyUniqid}).then((function(e){var t=e.ok,s=e.data,r=e.msg,n=e.code;if(1001===n)return o.$router.push("/qr_login");t?(o.$root.userInfo=s.userInfo,o.$st.set("USER_INFO",s.userInfo),o.$st.set("TOKEN",s.token),(0,f.Ks)(s.token),o.$root.refreshGlobalNotices(),o.$root.loadConfig(),o.$root.loadBanks(),o.$router.replace("/")):(o.refreshImageVerifyCode(),o.form.imgCode="",o.$toast.fail(r))})):this.$toast.fail("请输入合法的手机号码")},refreshImageVerifyCode:function(){var o=this;(0,a.mg)({codeType:"login"}).then((function(e){var t=e.ok,s=e.data,r=e.code;if(t)o.verifyUniqid=s.verifyUniqid,o.verifyImageBase64=s.verifyCode;else if(400==r)return o.$toast.fail("请输入合法的手机号码")}))},smsCount:function(){var o=this.$st.get("LAST_SMS_REQUEST");if(o){var e=Date.now()-Number(o);e<60&&(this.smsCountdown=1e3*(60-e))}},getSmsVerifyCode:function(){var o=this;this.smsCountdown||(0,a.Z3)({phoneNumber:this.form.phoneNumber,codeType:"register"}).then((function(e){var t=e.ok,s=e.msg;e.data;t?(o.$toast.success(s),o.smsCountdown=6e4,o.$st.set("LAST_SMS_REQUEST",Date.now())):o.$toast.fail(s)}))},onForgotPsw:function(){var o=this;this.$dialog.confirm({className:"retrievePsw",message:"找回密码,请联系客服",confirmButtonColor:"#6f59fe",confirmButtonText:"确认",cancelButtonText:"取消",beforeClose:function(e,t){"confirm"===e&&o.$root.openCustomerService(),t()}})}}},d=u,m=t(1001),c=(0,m.Z)(d,s,r,!1,null,null,null),l=c.exports},19248:function(o,e,t){t.d(e,{Z3:function(){return i},mg:function(){return r},pw:function(){return n}});var s=t(51922),r=function(o){return(0,s.q)({url:"/Api/Common/VerifyCode/getImageCode",method:"POST",data:o})},n=function(o){return(0,s.q)({url:"/Api/Common/VerifyCode/checkVerifyCode",method:"POST",data:o})},i=function(o){return(0,s.q)({url:"/Api/Common/VerifyCode/sendCode",method:"POST",data:o})}}}]);