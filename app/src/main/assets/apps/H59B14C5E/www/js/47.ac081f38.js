"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[47],{2047:function(a,t,e){e.r(t),e.d(t,{default:function(){return u}});var o=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("div",{staticClass:"page page-add_payment"},[e("div",{staticClass:"title title_line"},[a._v("请选择收款方式")]),e("van-radio-group",{model:{value:a.payment,callback:function(t){a.payment=t},expression:"payment"}},[e("van-cell-group",[e("van-cell",{attrs:{title:"银行卡",clickable:""},on:{click:function(t){a.payment=1}},scopedSlots:a._u([{key:"icon",fn:function(){return[e("div",{staticClass:"payment-icon bank"})]},proxy:!0},{key:"right-icon",fn:function(){return[e("van-radio",{attrs:{name:1}})]},proxy:!0}])}),e("van-cell",{attrs:{title:"微信支付",clickable:""},on:{click:a.$root.disablePayments},scopedSlots:a._u([{key:"icon",fn:function(){return[e("div",{staticClass:"payment-icon wechat"})]},proxy:!0},{key:"right-icon",fn:function(){return[e("van-radio",{attrs:{name:4,disabled:""}})]},proxy:!0}])}),e("van-cell",{attrs:{title:"支付宝支付",clickable:""},on:{click:a.$root.disablePayments},scopedSlots:a._u([{key:"icon",fn:function(){return[e("div",{staticClass:"payment-icon ali"})]},proxy:!0},{key:"right-icon",fn:function(){return[e("van-radio",{attrs:{name:2,disabled:""}})]},proxy:!0}])})],1)],1),1===a.payment?[e("div",{staticClass:"title secondary title_line"},[a._v("填写银行卡信息")]),e("van-form",{on:{submit:a.onSubmit}},[e("van-field",{attrs:{autocomplete:a.$root.getHash(),readonly:"",clickable:"",name:"bank",value:a.bankFormData.bankName,label:"银行名称",placeholder:"请选择开户行","input-align":"right","right-icon":"arrow"},on:{click:function(t){a.showBankPicker=!0}}}),e("van-field",{attrs:{autocomplete:a.$root.getHash(),readonly:"",clickable:"",name:"bankAddress",value:a.bankFormData.bankAddress,label:"开户所在地",placeholder:"请选择","input-align":"right","right-icon":"arrow"},on:{click:function(t){a.showBankAddressPicker=!0}}}),e("van-field",{attrs:{autocomplete:a.$root.getHash(),name:"bankBranch",label:"开户支行",placeholder:"选填","input-align":"right"},model:{value:a.bankFormData.bankBranch,callback:function(t){a.$set(a.bankFormData,"bankBranch",t)},expression:"bankFormData.bankBranch"}}),e("van-field",{attrs:{autocomplete:a.$root.getHash(),type:"digit",name:"bankNo",label:"卡号",placeholder:"储蓄卡"},model:{value:a.bankFormData.bankNo,callback:function(t){a.$set(a.bankFormData,"bankNo",t)},expression:"bankFormData.bankNo"}}),e("van-field",{attrs:{autocomplete:a.$root.getHash(),type:"password",name:"securePassword",label:"资金密码",placeholder:"6位纯数字资金密码",maxlength:"6"},model:{value:a.bankFormData.securePassword,callback:function(t){a.$set(a.bankFormData,"securePassword",t)},expression:"bankFormData.securePassword"}}),e("van-button",{staticClass:"block primary",attrs:{"native-type":"submit"}},[a._v(" 确定添加 ")])],1)]:a._e(),4===a.payment?[e("div",{staticClass:"title secondary title_line"},[a._v("填写微信信息")]),e("van-form",{on:{submit:a.onSubmit}},[e("van-field",{attrs:{autocomplete:a.$root.getHash(),name:"wechatAccount",label:"微信账号"},model:{value:a.wechatFormData.wechatAccount,callback:function(t){a.$set(a.wechatFormData,"wechatAccount",t)},expression:"wechatFormData.wechatAccount"}}),e("van-field",{attrs:{autocomplete:a.$root.getHash(),readonly:"",clickable:"","input-align":"right",name:"address",value:a.wechatFormData.address,label:"所在地区","right-icon":"arrow"},on:{click:function(t){a.showBankAddressPicker=!0}}}),e("div",{staticClass:"uploadWrapper"},[e("van-uploader",{class:{disableFile:a.$root.isH5Plus},attrs:{"after-read":function(t){return a.afterRead(t,"wechat")},"preview-full-image":"","max-count":1,"image-fit":"contain","result-type":"file"},nativeOn:{click:function(t){return function(t){return a.onClickUpload("wechat",t)}.apply(null,arguments)}},model:{value:a.wechatFormData.receiptCode,callback:function(t){a.$set(a.wechatFormData,"receiptCode",t)},expression:"wechatFormData.receiptCode"}},[e("van-button",{staticClass:"upload"},[e("van-icon",{attrs:{name:"plus"}}),e("div",{staticClass:"text"},[a._v("请上传收款码")])],1)],1)],1),e("van-field",{attrs:{autocomplete:a.$root.getHash(),type:"password",name:"securePassword",label:"资金密码",placeholder:"6位纯数字资金密码",maxlength:"6"},model:{value:a.wechatFormData.securePassword,callback:function(t){a.$set(a.wechatFormData,"securePassword",t)},expression:"wechatFormData.securePassword"}}),e("van-button",{staticClass:"block primary",attrs:{"native-type":"submit"}},[a._v(" 确定添加 ")])],1)]:a._e(),2===a.payment?[e("div",{staticClass:"title secondary title_line"},[a._v("填写支付宝信息")]),e("van-form",{on:{submit:a.onSubmit}},[e("van-field",{attrs:{autocomplete:a.$root.getHash(),name:"aliAccount",label:"支付宝账号"},model:{value:a.aliFormData.aliAccount,callback:function(t){a.$set(a.aliFormData,"aliAccount",t)},expression:"aliFormData.aliAccount"}}),e("van-field",{attrs:{autocomplete:a.$root.getHash(),readonly:"",clickable:"","input-align":"right",name:"address",value:a.aliFormData.address,label:"所在地区","right-icon":"arrow"},on:{click:function(t){a.showBankAddressPicker=!0}}}),e("div",{staticClass:"uploadWrapper"},[e("van-uploader",{attrs:{"after-read":function(t){return a.afterRead(t,"ali")},"preview-full-image":"","max-count":1,"image-fit":"contain","result-type":"file"},nativeOn:{click:function(t){return function(t){return a.onClickUpload("ali",t)}.apply(null,arguments)}},model:{value:a.aliFormData.receiptCode,callback:function(t){a.$set(a.aliFormData,"receiptCode",t)},expression:"aliFormData.receiptCode"}},[e("van-button",{staticClass:"upload"},[e("van-icon",{attrs:{name:"plus"}}),e("div",{staticClass:"text"},[a._v("请上传收款码")])],1)],1)],1),e("van-field",{attrs:{autocomplete:a.$root.getHash(),type:"password",name:"securePassword",label:"资金密码",placeholder:"6位纯数字资金密码",maxlength:"6"},model:{value:a.aliFormData.securePassword,callback:function(t){a.$set(a.aliFormData,"securePassword",t)},expression:"aliFormData.securePassword"}}),e("van-button",{staticClass:"block primary",attrs:{"native-type":"submit"}},[a._v(" 确定添加 ")])],1)]:a._e(),e("van-popup",{attrs:{position:"bottom"},model:{value:a.showBankPicker,callback:function(t){a.showBankPicker=t},expression:"showBankPicker"}},[e("van-picker",{attrs:{"show-toolbar":"","value-key":"bankName",columns:a.$root.banks},on:{confirm:a.onConfirmPickBank,cancel:function(t){a.showBankPicker=!1}}})],1),e("van-popup",{attrs:{position:"bottom"},model:{value:a.showBankAddressPicker,callback:function(t){a.showBankAddressPicker=t},expression:"showBankAddressPicker"}},[e("van-area",{attrs:{title:"标题","area-list":a.areaList,"columns-num":2},on:{confirm:a.onConfirmAddress}})],1)],2)},s=[],r=e(7601),i=e(3652),n=e(1161),c={data(){return{payment:1,showBankPicker:!1,showBankAddressPicker:!1,areaList:r.H,bankFormData:{bankId:"",bankName:"",bankAddress:"",provinceId:"",cityId:"",bankBranch:"",bankNo:"",securePassword:""},wechatFormData:{wechatAccount:"",securePassword:"",address:"",provinceId:"",cityId:"",receiptCode:[]},aliFormData:{aliAccount:"",securePassword:"",address:"",provinceId:"",cityId:"",receiptCode:[]}}},watch:{payment(a){1!=a&&(this.bankFormData={bankId:"",bankName:"",bankAddress:"",provinceId:"",cityId:"",bankBranch:"",bankNo:"",securePassword:""}),2!=a&&(this.aliFormData={aliAccount:"",securePassword:"",address:"",provinceId:"",cityId:"",receiptCode:[]}),4!=a&&(this.wechatFormData={wechatAccount:"",securePassword:"",address:"",provinceId:"",cityId:"",receiptCode:[]})}},created(){this.$root.$emit("root:set-topbar",["left-back"]),this.payment=Number(this.$route.params.index||1)},methods:{onConfirmPickBank({bankId:a,bankName:t}){this.bankFormData.bankId=a,this.bankFormData.bankName=t,this.showBankPicker=!1},onConfirmAddress(a){const[t,e]=a;1==this.payment&&(this.bankFormData.provinceId=t.code,this.bankFormData.cityId=e.code,this.bankFormData.bankAddress=t.name+"  "+e.name),2==this.payment&&(this.aliFormData.provinceId=t.code,this.aliFormData.cityId=e.code,this.aliFormData.address=t.name+"  "+e.name),4==this.payment&&(this.wechatFormData.provinceId=t.code,this.wechatFormData.cityId=e.code,this.wechatFormData.address=t.name+"  "+e.name),this.showBankAddressPicker=!1},afterRead(a,t){a.status="uploading",a.message="上传中...";const e="wechat"===t?"wechatFormData":"ali"===t?"aliFormData":"",o=this[e].receiptCode[0];(0,n.ws)({imgFile:a.file,type:"other"}).then((({ok:t,data:s,msg:r})=>{t?(a.status="done",o.url=this.$root.getImageUrl(s.name),this[e].receiptCode=[o]):(a.status="error",a.message="上传失败",this.$toast.fail(r))}))},onSubmit(){const a={type:this.payment};if(1==this.payment){if(!this.bankFormData.bankId)return this.$toast.fail("请选择银行");if(!this.bankFormData.bankAddress)return this.$toast.fail("请选择开户所在地");if(!this.bankFormData.bankNo)return this.$toast.fail("请输入银行卡号");if(this.bankFormData.bankNo.length<10||this.bankFormData.bankNo.length>20)return this.$toast.fail("银行卡号为10-20位数字");if(!/^\d{6}$/.test(this.bankFormData.securePassword))return this.$toast.fail("请输入6数字组成的资金密码");Object.assign(a,{bankNo:this.bankFormData.bankNo,bankId:this.bankFormData.bankId,bankBranch:this.bankFormData.bankBranch,provinceId:this.bankFormData.provinceId,cityId:this.bankFormData.cityId,securePassword:this.bankFormData.securePassword})}if(2==this.payment){if(!this.aliFormData.aliAccount)return this.$toast.fail("请输入微信账号");if(!this.aliFormData.address)return this.$toast.fail("请输入所在地区");if(this.aliFormData.receiptCode.length<=0)return this.$toast.fail("请上传收款码");if(!/^\d{6}$/.test(this.aliFormData.securePassword))return this.$toast.fail("请输入6数字组成的资金密码");Object.assign(a,{account:this.aliFormData.aliAccount,provinceId:this.aliFormData.provinceId,cityId:this.aliFormData.cityId,receiptCode:this.aliFormData.receiptCode[0].url,securePassword:this.aliFormData.securePassword})}if(4==this.payment){if(!this.wechatFormData.wechatAccount)return this.$toast.fail("请输入微信账号");if(!this.wechatFormData.address)return this.$toast.fail("请输入所在地区");if(this.wechatFormData.receiptCode.length<=0)return this.$toast.fail("请上传收款码");if(!/^\d{6}$/.test(this.wechatFormData.securePassword))return this.$toast.fail("请输入6数字组成的资金密码");Object.assign(a,{account:this.wechatFormData.wechatAccount,provinceId:this.wechatFormData.provinceId,cityId:this.wechatFormData.cityId,receiptCode:this.wechatFormData.receiptCode[0].url,securePassword:this.wechatFormData.securePassword})}(0,i._w)(a).then((({ok:a,data:t,msg:e})=>{a?(this.resetForm(),this.$toast.success(e)):this.$toast.fail(e)}))},resetForm(){this.bankFormData={bankId:"",bankName:"",bankAddress:"",provinceId:"",cityId:"",bankBranch:"",bankNo:"",securePassword:""},this.aliFormData={aliAccount:"",securePassword:"",address:"",provinceId:"",cityId:"",receiptCode:[]},this.wechatFormData={wechatAccount:"",securePassword:"",address:"",provinceId:"",cityId:"",receiptCode:[]}},onClickUpload(a,t){this.$root.isH5Plus&&(t.preventDefault(),window.h5p.uploadImage((t=>{if(t){const e="wechat"===a?"wechatFormData":"ali"===a?"aliFormData":"";e&&(this.form[e].receiptCode.push({file:{file:t}}),this.afterRead({file:t},a))}else this.$toast.fail("获取图片失败")}),!0))}}},l=c,d=e(1001),m=(0,d.Z)(l,o,s,!1,null,null,null),u=m.exports}}]);