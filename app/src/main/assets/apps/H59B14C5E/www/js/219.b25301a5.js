"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[219],{8219:function(t,e,r){r.r(e),r.d(e,{default:function(){return _}});var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"page page-transaction_sale"},[r("div",{staticClass:"top-wrapper"},[r("div",{staticClass:"card"},[r("div",{staticClass:"title"},[r("span",{staticClass:"split"},[t._v(" "+t._s(t.orderInfo.isSplit?"可拆分":"不可拆分")+" ")]),0===t.orderInfo.status?r("span",{staticClass:"status canceled"},[t._v(" 取消挂单 ")]):r("span",{staticClass:"status",class:t._f("transactingOrderStatus")(t.status)},[t._v(" "+t._s(t._f("transactingOrderStatus")(t.status,"seller-content"))+" ")]),r("span",{staticClass:"btn",class:{loading:t.loading},on:{click:function(){return t.loadDetails(t.orderInfo.pendingOrderId)}}},[r("van-icon",{attrs:{name:"replay"}})],1)]),r("div",{staticClass:"time"},[t.status==t.TRANSACTING_ORDER_STATUS.HANGING?[t._v(" 创建时间 "+t._s(t._f("dateFormat")(t.orderInfo.createTime,"Y/M/D h:m:s"))+" ")]:t._e(),t.status==t.TRANSACTING_ORDER_STATUS.BUYER_REQUEST?[t._v(" 5分钟内未操作系统将默认卖家取消交易 ")]:[t._v("   ")]],2),r("div",{staticClass:"orderId"},[t._v(" 挂单编号 "+t._s(t.orderInfo.pendingOrderId)+" "),r("button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:t.orderInfo.pendingOrderId||"",expression:"orderInfo.pendingOrderId || ''"}],staticClass:"copy copyBtn",on:{success:t.$root.copySuccessful}})])])]),r("van-cell",{staticClass:"kv amount",attrs:{title:"售卖数量"}},[t._v(" Ezb "+t._s(t.orderInfo.validAmount)+" ")]),t.status==t.TRANSACTING_ORDER_STATUS.BUYER_REQUEST?[r("div",{staticClass:"underOrders gary-8"},[r("div",{staticClass:"title title_line"},[t._v("交易订单")]),r("div",{staticClass:"list"},t._l(t.underOrders,(function(e,a){return r("div",{key:a,staticClass:"item border_bottom_1px",on:{click:function(r){return t.$router.push("/transaction_sale/"+e.orderId)}}},[r("div",{staticClass:"col time"},[t._v(" 发起时间 "),r("br"),t._v(" "+t._s(t._f("dateFormat")(e.createTime,"M/D h:m:s"))+" ")]),r("div",{staticClass:"col money"},[r("div",[t._v("购买数量")]),r("div",{staticClass:"amount"},[t._v(" "+t._s(parseFloat(e.amount).toFixed(2))+"EzB ")])]),r("div",{staticClass:"col payment",class:"pay"+e.paymentType}),r("div",{staticClass:"col status",class:t._f("transactingOrderStatus")(e.status)},[t._v(" "+t._s(t._f("transactingOrderStatus")(e.status,"seller-content"))+" ")]),r("van-icon",{attrs:{name:"arrow"}})],1)})),0)])]:[t.status==t.TRANSACTING_ORDER_STATUS.BUYER_REQUEST?r("van-cell",{staticClass:"kv amount",attrs:{title:"购买数量"}},[t._v(" Ezb 60000 ")]):t._e(),r("van-cell",{staticClass:"kv payment",attrs:{title:"收款方式"}},[r("van-radio-group",{model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},t._l(t.payments,(function(e,a){return r("van-radio",{key:a,staticClass:"btn",attrs:{name:e}},[r("van-button",{staticClass:"btn",attrs:{slot:"icon"},slot:"icon"},[r("span",{staticClass:"item",class:"pay"+e}),t._v(" "+t._s(t._f("paymentMethod")(e,"content"))+" ")])],1)})),1)],1)],t.status==t.TRANSACTING_ORDER_STATUS.HANGING?r(t.componentsMapping[t.radio],{tag:"components",attrs:{title:"收款信息",hide:t.hide,payment:t.hide?void 0:t.getPaymentInfo.info}}):t._e(),0!=t.orderInfo.status?r("div",{staticClass:"btns"},[t.status==t.TRANSACTING_ORDER_STATUS.HANGING?[r("van-button",{staticClass:"danger block",on:{click:t.cancel_hanging}},[t._v(" 取消挂单 ")])]:t._e()],2):t._e()],2)},s=[],n=r(5628),i=r(1688),o=r(7025),d=r(1380),l={components:{BankPaymentInfo:o.JF,WechatPaymentInfo:o.Ey,AliPaymentInfo:o.q$},data(){return{STATUS_TYPE:n.Z2,STEP:n.g0,TRANSACTING_ORDER_STATUS:n.eD,status:n.eD.HANGING,countdown:1,isTimeOut:!1,loading:!1,radio:"",orderInfo:{},orderPayments:[],underOrders:[],componentsMapping:{[n.hL.BANK]:"BankPaymentInfo",[n.hL.ALI]:"AliPaymentInfo",[n.hL.WE_CHAT]:"WechatPaymentInfo"}}},computed:{hide(){return this.status==this.TRANSACTING_ORDER_STATUS.SELLER_CANCELED_DEAL||this.status==this.TRANSACTING_ORDER_STATUS.BUYRER_CANCELD_DEAL||this.status==this.TRANSACTING_ORDER_STATUS.SELLER_DID_NOT_RECEIVE&&this.isCountdownEnd||this.status==this.TRANSACTING_ORDER_STATUS.CONFIRM_TRANSFER||this.status==this.TRANSACTING_ORDER_STATUS.CANCELED_BY_OFFICIAL||this.status==this.TRANSACTING_ORDER_STATUS.CONFIRMED_BY_OFFICIAL||this.status==this.TRANSACTING_ORDER_STATUS.DEAL||this.status==this.TRANSACTING_ORDER_STATUS.TIME_OVER},isCountdownEnd(){return this.countdown<=0},stepsActive(){return this.STEP[this.status]},isTimeoutDisputing(){return!(this.status!=this.TRANSACTING_ORDER_STATUS.DISPUTING||!this.isTimeOut)},payments(){return this.$root.parsePayments(this.orderInfo.paymentType)},getPaymentInfo(){return this.orderPayments.find((t=>t.type===this.radio))||{}}},created(){this.loadDetails(this.$route.params.id),this.$root.$emit("root:set-topbar",["left-back","customer-service"])},beforeDestroy(){clearTimeout(this.timer)},methods:{transactingOrderStatus(...t){return this.$options.filters.transactingOrderStatus(...t)},cancel_hanging(){this.cancelHangOrder()},start_transaction(){(0,i.H9)()},cancel_transaction(){(0,i.VN)(2)},loadDetails(t){this.loading||(this.loading=!0,(0,d.cf)({pendingOrderId:t}).then((({ok:e,msg:r,data:a})=>{this.loading=!1,e?(this.orderInfo=a.pendingOrder,this.orderPayments=a.paymentType,this.radio=this.payments[0],this.orderInfo.underwayOrder>0?(this.status=n.eD.BUYER_REQUEST,this.loadUnderOrders()):(this.status=n.eD.HANGING,this.underOrders=[]),0!==this.orderInfo.status&&(this.timer=setTimeout((()=>this.loadDetails(t)),1e4))):this.$toast.fail(r)})))},loadUnderOrders(){(0,d.vi)({pendingOrderId:this.orderInfo.pendingOrderId,page:1,pageSize:20}).then((({ok:t,msg:e,data:r})=>{t?this.underOrders=r.list:this.$toast.fail(e)}))},cancelHangOrder(){(0,d.$i)({pendingOrderId:this.orderInfo.pendingOrderId}).then((({ok:t,msg:e})=>{t?(this.$router.back(),this.$toast.success(e)):this.$toast.fail(e)}))}}},c=l,u=r(1001),p=(0,u.Z)(c,a,s,!1,null,null,null),_=p.exports},1380:function(t,e,r){r.d(e,{$Z:function(){return d},$i:function(){return o},CI:function(){return h},Ej:function(){return v},Hn:function(){return c},N8:function(){return f},R9:function(){return S},T7:function(){return A},XW:function(){return y},_H:function(){return s},_d:function(){return T},an:function(){return _},cf:function(){return p},dF:function(){return u},fW:function(){return l},l$:function(){return C},uF:function(){return n},v1:function(){return i},vi:function(){return m},y6:function(){return O}});var a=r(1922);const s=t=>(0,a.q)({url:"/Api/Market/PendingOrder/marketPendingOrderList",method:"POST",data:t}),n=t=>(0,a.q)({url:"/Api/Market/Order/myOrderList",method:"GET",data:t}),i=t=>(0,a.q)({url:"/Api/Market/Sell/index",method:"POST",data:t}),o=t=>(0,a.q)({url:"/Api/Market/Sell/recycle",method:"POST",data:t}),d=t=>(0,a.q)({url:"Api/Market/PendingOrder/myPendingOrderList",method:"POST",data:t}),l=t=>(0,a.q)({url:"/Api/Market/Order/myOrderDetail",method:"GET",data:t}),c=t=>(0,a.q)({url:"/Api/Market/PendingOrder/marketPendingOrderDetail",method:"POST",data:t}),u=t=>(0,a.q)({url:"/Api/Market/Order/getCurrentOrderStatus",method:"GET",data:t}),p=t=>(0,a.q)({url:"/Api/Market/PendingOrder/myPendingOrderDetail",method:"GET",data:t}),_=t=>(0,a.q)({url:"/Api/Market/Order/buyerCreatesOrder",method:"POST",data:t}),m=t=>(0,a.q)({url:"/Api/Market/PendingOrder/getOrderListByPendingOrder",method:"GET",data:t}),h=t=>(0,a.q)({url:"/Api/Market/Order/sellerRefusesToCreateOrder",method:"POST",data:t}),f=t=>(0,a.q)({url:"/Api/Market/Order/sellerConfirmsToCreateOrder",method:"POST",data:t}),v=t=>(0,a.q)({url:"/Api/Market/Order/sellerHasNotReceivedPayment",method:"POST",data:t}),y=t=>(0,a.q)({url:"/Api/Market/Order/sellerCompletesOrder",method:"POST",data:t}),T=t=>(0,a.q)({url:"/Api/Market/Order/buyerCancelsOrder",method:"POST",data:t}),C=t=>(0,a.q)({url:"/Api/Market/Order/buyerConfirmsOrderHasBeenPaid",method:"POST",data:t}),S=t=>(0,a.q)({url:"/Api/Market/Order/buyerAppeals",method:"POST",data:t}),O=t=>(0,a.q)({url:"/Api/Market/Order/getCancelsOrderDailyCount",method:"GET",data:t}),A=t=>(0,a.q)({url:"/Api/User/TransferOrder/userDeposit",method:"POST",data:t})},1688:function(t,e,r){r.d(e,{EQ:function(){return o},H9:function(){return n},VN:function(){return i},di:function(){return d}});var a=r(9515);const s=(t,e)=>new Promise(((r,s)=>{a.Z.confirm({title:t,message:e,confirmButtonText:"是",cancelButtonText:"否",confirmButtonColor:"#6f59fe",allowHtml:!0,beforeClose(t,e){e(),"confirm"===t?r():s()}})})),n=()=>s("是否开始交易","<div>\n开始交易后可在“交易记录”，“订单”中\n「我的卖单」完成后续操作\n</div>"),i=(t,e=3)=>s("是否取消该笔交易",`<div>\n      <div class="tip">\n        提示：\n      </div>\n      <div>\n          1.如果你在一天内取消<span style="color:#FB2222">${e}次</span>订单，当天你的账户将会被停止买卖。\n      </div>\n      <div class="al-c">\n          今日还可取消\n          <span style="color:#FB2222">${t}次</span>\n          订单，请谨慎操作\n      </div>\n    </div>\n`),o=()=>s("是否未收到转账",'请再次确认您的收款账户是否未收到转账，\n如发现\n<span style="color:#FB2222">恶意不确认转币</span>\n可能会面临\n<span style="color:#FB2222">「永久封号」</span>\n处理'),d=()=>s("是否收到转账",'请再次确认买家否已付款，且到款信息\n是否与<span style="color:#FB2222">「买方付款信息」</span>一致')},7025:function(t,e,r){r.d(e,{q$:function(){return O},JF:function(){return c},Ey:function(){return f}});var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("van-cell-group",{attrs:{border:!1},scopedSlots:t._u([{key:"title",fn:function(){return[r("span",{staticClass:"title"},[t._v(t._s(t.title))]),t._t("title-right")]},proxy:!0}],null,!0)},[r("van-cell",{staticClass:"kv",attrs:{title:"银行名称",border:!1}},[t._v(" "+t._s(t._f("hide")(t.findBank.bankName,t.hide))+" ")]),r("van-cell",{staticClass:"kv",attrs:{title:"开户所在地",border:!1}},[t._v(" "+t._s(t._f("hide")(t.getAddrFromCode(t.payment.province,t.payment.city),t.hide))+" ")]),r("van-cell",{staticClass:"kv",attrs:{title:"开户支行",border:!1}},[t._v(" "+t._s(t._f("hide")(t.payment.bankBranch,t.hide))+" ")]),r("van-cell",{staticClass:"kv",attrs:{title:"姓名",border:!1},scopedSlots:t._u([{key:"right-icon",fn:function(){return[r("div",{staticClass:"copy"})]},proxy:!0}])},[t._v(" "+t._s(t._f("hide")(t.payment.realName,t.hide))+" ")]),r("van-cell",{staticClass:"kv",attrs:{title:"银行卡号",border:!1},scopedSlots:t._u([{key:"right-icon",fn:function(){return[r("div",{staticClass:"copy"})]},proxy:!0}])},[t._v(" "+t._s(t._f("hide")(t.payment.bankNo,t.hide))+" ")])],1)},s=[],n=r(7601),i={props:{title:String,hide:Boolean,payment:{default:()=>({bankName:"中国农业银行",province:11e4,city:110100,bankBranch:"黄浦区万达广场支行",realName:"张三",bankNo:"6227 0029 6666 7777 888"})}},computed:{findBank(){return this.$root.banks.find((t=>t.bankId==this.payment.bankId))||{}}},methods:{getAddrFromCode(t,e){return n.H.province_list[t]+" "+n.H.city_list[e]}}},o=i,d=r(1001),l=(0,d.Z)(o,a,s,!1,null,"2f5b596d",null),c=l.exports,u=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("van-cell-group",{attrs:{border:!1},scopedSlots:t._u([{key:"title",fn:function(){return[r("span",{staticClass:"title"},[t._v(t._s(t.title))])]},proxy:!0}])},[r("div",{staticClass:"wrapper"},[r("div",{staticClass:"left"},[r("van-cell",{staticClass:"kv",attrs:{title:"微信账号",border:!1},scopedSlots:t._u([{key:"right-icon",fn:function(){return[r("button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:t.hide?"":t.payment.account||"",expression:"hide ? '' : payment.account || ''"}],staticClass:"copy copyBtn",on:{success:t.$root.copySuccessful}})]},proxy:!0}])},[t._v(" "+t._s(t._f("hide")(t.payment.account,t.hide))+" ")]),r("van-cell",{staticClass:"kv",attrs:{title:"姓名",border:!1},scopedSlots:t._u([{key:"right-icon",fn:function(){return[r("button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:t.hide?"":t.payment.realName||"",expression:"hide ? '' : payment.realName || ''"}],staticClass:"copy copyBtn",on:{success:t.$root.copySuccessful}})]},proxy:!0}])},[t._v(" "+t._s(t._f("hide")(t.payment.realName,t.hide))+" ")])],1),t.hide?r("div",{staticClass:"qr"},[[t._v(" 收款二维码 ")]],2):r("van-image",{attrs:{src:t.hide?"":t.$root.getImageUrl(t.payment.receiptCode)}})],1)])},p=[],_={props:{title:String,hide:Boolean,payment:{default:()=>({account:"微信",realName:"张三",receiptCode:""})}}},m=_,h=(0,d.Z)(m,u,p,!1,null,"502e4e80",null),f=h.exports,v=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("van-cell-group",{attrs:{border:!1},scopedSlots:t._u([{key:"title",fn:function(){return[r("span",{staticClass:"title"},[t._v(t._s(t.title))])]},proxy:!0}])},[r("div",{staticClass:"wrapper"},[r("div",{staticClass:"left"},[r("van-cell",{staticClass:"kv",attrs:{title:"支付宝账号",border:!1},scopedSlots:t._u([{key:"right-icon",fn:function(){return[r("button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:t.hide?"":t.payment.account||"",expression:"hide ? '' : payment.account || ''"}],staticClass:"copy copyBtn",on:{success:t.$root.copySuccessful}})]},proxy:!0}])},[t._v(" "+t._s(t._f("hide")(t.payment.account,t.hide))+" ")]),r("van-cell",{staticClass:"kv",attrs:{title:"姓名",border:!1},scopedSlots:t._u([{key:"right-icon",fn:function(){return[r("button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:t.hide?"":t.payment.realName||"",expression:"hide ? '' : payment.realName || ''"}],staticClass:"copy copyBtn",on:{success:t.$root.copySuccessful}})]},proxy:!0}])},[t._v(" "+t._s(t._f("hide")(t.payment.realName,t.hide))+" ")])],1),t.hide?r("div",{staticClass:"qr"},[[t._v(" 收款二维码 ")]],2):r("van-image",{attrs:{src:t.hide?"":t.$root.getImageUrl(t.payment.receiptCode)}})],1)])},y=[],T={props:{title:String,hide:Boolean,payment:{default:()=>({account:"支付宝",realName:"张三",receiptCode:""})}}},C=T,S=(0,d.Z)(C,v,y,!1,null,"68e8d54c",null),O=S.exports}}]);