"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[470],{93470:function(t,e,n){n.r(e),n.d(e,{default:function(){return p}});var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page page-messages"},[n("van-list",{attrs:{error:t.error,"error-text":t.errorText,finished:t.finished,"finished-text":"暂无更多消息"},on:{"update:error":function(e){t.error=e},load:t.loadList},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[n("van-checkbox-group",{on:{change:t.onCheckboxGroupChange},model:{value:t.deleteList,callback:function(e){t.deleteList=e},expression:"deleteList"}},t._l(t.list,(function(e,i){return n("van-cell",{key:i,class:{disabled:"Read"===e.status},attrs:{title:e.title,label:t._f("dateFormat")(e.createTime,"Y-M-D"),"is-link":"",clickable:""},on:{click:function(){return t.handlerClickMsg(e)}}},[n("template",{slot:"icon"},[n("van-checkbox",{attrs:{name:e.contentId},nativeOn:{click:function(t){return t.stopPropagation(),function(t){}.apply(null,arguments)}}})],1)],2)})),1)],1)],1)},r=[],o=n(68932),a=n(23796),s=n(4367),l=(n(69600),n(41539),n(57327),n(21249),n(13652)),c={data:function(){return{loading:!1,error:!1,finished:!1,errorText:"加载失败，点击重试",list:[],page:1,pageSize:20,deleteList:[]}},created:function(){this.setTopBar()},methods:{setTopBar:function(t){var e=this;t?this.$root.$emit("root:set-topbar",["left-back","custom-btn"],{label:"一键删除",onClick:function(){(0,l.qP)({contentId:e.deleteList.join(",")}).then((function(t){var n=t.ok,i=t.msg;if(n){var r=e.deleteList.reduce((function(t,e){return(0,s.Z)((0,s.Z)({},t),{},(0,a.Z)({},e,1))}),{});e.list=e.list.filter((function(t){return!r[t.contentId]})),e.deleteList=[]}else e.$notice.fail(i)}))}}):this.$root.$emit("root:set-topbar",["left-back","custom-btn"],{label:"一键已读",onClick:function(){(0,l.Mj)().then((function(t){var n=t.ok,i=t.msg;n?e.list.map((function(t){return t.status="Read",t})):e.$notice.fail(i)}))}})},onCheckboxGroupChange:function(){this.deleteList.length?this.setTopBar(!0):this.setTopBar()},loadList:function(){var t=this;(0,l._U)({page:this.page,pageSize:this.pageSize}).then((function(e){var n=e.ok,i=e.data,r=e.msg;if(t.loading=!1,n){var a;if(1===t.page)t.list=i.list||[];else(a=t.list).push.apply(a,(0,o.Z)(i.list||[]));t.finished=t.page*t.pageSize>=i.total,t.page+=1}else t.error=!0,t.errorText=r}))},handlerClickMsg:function(t){var e=this,n=t.status,i=t.contentId,r=t.content;"Unread"===n?(0,l.$h)({contentId:i}).then((function(t){var n=t.ok,i=t.msg;n?(e.$st.set("MSG_CONTENT",r),e.$router.push("/msg_detail")):e.$notice.fail(i)})):(this.$st.set("MSG_CONTENT",r),this.$router.push("/msg_detail"))}}},u=c,f=n(1001),d=(0,f.Z)(u,i,r,!1,null,null,null),p=d.exports},68932:function(t,e,n){n.d(e,{Z:function(){return l}});var i=n(23748);function r(t){if(Array.isArray(t))return(0,i.Z)(t)}n(82526),n(41817),n(41539),n(32165),n(78783),n(33948),n(91038);function o(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var a=n(48936);n(21703);function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(t){return r(t)||o(t)||(0,a.Z)(t)||s()}}}]);