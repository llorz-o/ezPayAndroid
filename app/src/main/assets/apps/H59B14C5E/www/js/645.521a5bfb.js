"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[645],{18528:function(t,s,a){a.r(s),a.d(s,{default:function(){return f}});var n=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"page page-transaction_sale"},[a("div",{staticClass:"top-wrapper"},[a("div",{staticClass:"card"},[a("div",{staticClass:"title"},[a("span",{staticClass:"split"},[t._v(" "+t._s(t.orderInfo.isSplit?"可拆分":"不可拆分")+" ")]),0===t.orderInfo.status?a("span",{staticClass:"status canceled"},[t._v(" "+t._s(t.orderInfo.amount==t.orderInfo.soldAmount?"已售罄":"取消挂单")+" ")]):a("span",{staticClass:"status",class:t._f("transactingOrderStatus")(t.status)},[t._v(" "+t._s(t._f("transactingOrderStatus")(t.status,"seller-content"))+" ")]),a("span",{staticClass:"btn",class:{loading:t.loading},on:{click:function(){return t.loadDetails(t.orderInfo.pendingOrderId)}}},[a("van-icon",{attrs:{name:"replay"}})],1)]),a("div",{staticClass:"time"},[t.status==t.TRANSACTING_ORDER_STATUS.HANGING?[t._v(" 创建时间 "+t._s(t._f("dateFormat")(t.orderInfo.createTime,"Y/M/D h:m:s"))+" ")]:t._e(),t.status==t.TRANSACTING_ORDER_STATUS.BUYER_REQUEST?[a("span",{staticStyle:{color:"red"}},[t._v(" "+t._s(t.$root.waitingSellerConfirmOrderStr)+" ")]),t._v(" 内未操作系统将默认卖家取消交易 ")]:[t._v("   ")]],2),a("div",{staticClass:"orderId"},[t._v(" 挂单编号 "+t._s(t.orderInfo.pendingOrderNo)+" "),a("button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:t.orderInfo.pendingOrderNo||"",expression:"orderInfo.pendingOrderNo || ''"}],staticClass:"copy copyBtn",on:{success:t.$root.copySuccessful}})])])]),a("van-cell",{staticClass:"kv amount",attrs:{title:"售卖数量"}},[t._v(" V币 "+t._s(t.orderInfo.validAmount)+" ")]),t.status==t.TRANSACTING_ORDER_STATUS.BUYER_REQUEST?[a("div",{staticClass:"underOrders gary-8"},[a("div",{staticClass:"title title_line"},[t._v("交易订单")]),a("div",{staticClass:"list"},t._l(t.underOrders,(function(s,n){return a("div",{key:n,staticClass:"item border_bottom_1px",on:{click:function(a){return t.$router.push("/transaction_sale/"+s.orderId)}}},[a("div",{staticClass:"col time"},[t._v(" 发起时间 "),a("br"),t._v(" "+t._s(t._f("dateFormat")(s.createTime,"M/D h:m:s"))+" ")]),a("div",{staticClass:"col money"},[a("div",[t._v("购买数量")]),a("div",{staticClass:"amount"},[t._v(" "+t._s(parseFloat(s.amount).toFixed(2))+"V币 ")])]),a("div",{staticClass:"col payment",class:"pay"+s.paymentType}),a("div",{staticClass:"col status",class:t._f("transactingOrderStatus")(s.status)},[t._v(" "+t._s(t._f("transactingOrderStatus")(s.status,"seller-content"))+" ")]),a("van-icon",{attrs:{name:"arrow"}})],1)})),0)])]:[a("van-cell",{staticClass:"kv payment",attrs:{title:"收款方式"}},[a("van-radio-group",{model:{value:t.radio,callback:function(s){t.radio=s},expression:"radio"}},t._l(t.payments,(function(s,n){return a("van-radio",{key:n,staticClass:"btn",attrs:{name:s}},[a("van-button",{staticClass:"btn",attrs:{slot:"icon"},slot:"icon"},[a("span",{staticClass:"item",class:"pay"+s}),t._v(" "+t._s(t._f("paymentMethod")(s,"content"))+" ")])],1)})),1)],1)],t.status==t.TRANSACTING_ORDER_STATUS.HANGING?a(t.componentsMapping[t.radio],{tag:"components",attrs:{title:"收款信息",hide:t.hide,payment:t.hide?void 0:t.getPaymentInfo.info}}):t._e(),0!=t.orderInfo.status?a("div",{staticClass:"btns"},[t.status==t.TRANSACTING_ORDER_STATUS.HANGING?[a("van-button",{staticClass:"danger block",on:{click:t.cancel_hanging}},[t._v(" 取消挂单 ")])]:t._e()],2):t._e()],2)},e=[],r=a(23796),i=(a(69826),a(41539),a(75628)),o=a(51688),d=a(29816),c=a(21380),u={components:{BankPaymentInfo:d.JF,WechatPaymentInfo:d.Ey,AliPaymentInfo:d.q$},data:function(){var t;return{STATUS_TYPE:i.Z2,STEP:i.g0,TRANSACTING_ORDER_STATUS:i.eD,status:i.eD.HANGING,countdown:1,isTimeOut:!1,loading:!1,radio:"",orderInfo:{},orderPayments:[],underOrders:[],componentsMapping:(t={},(0,r.Z)(t,i.hL.BANK,"BankPaymentInfo"),(0,r.Z)(t,i.hL.ALI,"AliPaymentInfo"),(0,r.Z)(t,i.hL.WE_CHAT,"WechatPaymentInfo"),t)}},computed:{hide:function(){return this.status==this.TRANSACTING_ORDER_STATUS.SELLER_CANCELED_DEAL||this.status==this.TRANSACTING_ORDER_STATUS.BUYRER_CANCELD_DEAL||this.status==this.TRANSACTING_ORDER_STATUS.SELLER_DID_NOT_RECEIVE&&this.isCountdownEnd||this.status==this.TRANSACTING_ORDER_STATUS.CONFIRM_TRANSFER||this.status==this.TRANSACTING_ORDER_STATUS.CANCELED_BY_OFFICIAL||this.status==this.TRANSACTING_ORDER_STATUS.CONFIRMED_BY_OFFICIAL||this.status==this.TRANSACTING_ORDER_STATUS.DEAL||this.status==this.TRANSACTING_ORDER_STATUS.TIME_OVER},isCountdownEnd:function(){return this.countdown<=0},stepsActive:function(){return this.STEP[this.status]},isTimeoutDisputing:function(){return!(this.status!=this.TRANSACTING_ORDER_STATUS.DISPUTING||!this.isTimeOut)},payments:function(){return this.$root.parsePayments(this.orderInfo.paymentType)},getPaymentInfo:function(){var t=this;return this.orderPayments.find((function(s){return s.type===t.radio}))||{}}},created:function(){this.loadDetails(this.$route.params.id),this.$root.$emit("root:set-topbar",["left-back","customer-service"])},beforeDestroy:function(){clearTimeout(this.timer)},methods:{transactingOrderStatus:function(){var t;return(t=this.$options.filters).transactingOrderStatus.apply(t,arguments)},cancel_hanging:function(){this.cancelHangOrder()},start_transaction:function(){(0,o.H9)()},cancel_transaction:function(){(0,o.VN)(2)},loadDetails:function(t){var s=this;this.loading||(this.loading=!0,(0,c.cf)({pendingOrderId:t}).then((function(a){var n=a.ok,e=a.msg,r=a.data;s.loading=!1,n?(s.orderInfo=r.pendingOrder,s.orderPayments=r.paymentType,s.radio=s.payments[0],s.orderInfo.underwayOrder>0?(s.status=i.eD.BUYER_REQUEST,s.loadUnderOrders()):(s.status=i.eD.HANGING,s.underOrders=[]),0!==s.orderInfo.status&&(s.timer=setTimeout((function(){return s.loadDetails(t)}),1e4))):s.$toast.fail(e)})))},loadUnderOrders:function(){var t=this;(0,c.vi)({pendingOrderId:this.orderInfo.pendingOrderId,page:1,pageSize:20}).then((function(s){var a=s.ok,n=s.msg,e=s.data;a?t.underOrders=e.list:t.$toast.fail(n)}))},cancelHangOrder:function(){var t=this;(0,c.$i)({pendingOrderId:this.orderInfo.pendingOrderId}).then((function(s){var a=s.ok,n=s.msg;a?(t.$router.back(),t.$toast.success(n)):t.$toast.fail(n)}))}}},l=u,_=a(1001),T=(0,_.Z)(l,n,e,!1,null,null,null),f=T.exports}}]);