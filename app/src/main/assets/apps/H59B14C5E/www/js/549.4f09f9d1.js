"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[549],{77376:function(t,s,a){a.r(s),a.d(s,{default:function(){return f}});var e=function(){var t,s=this,a=s.$createElement,e=s._self._c||a;return e("div",{staticClass:"page page-transaction_sale"},[e("div",{staticClass:"top-wrapper"},[e("div",{staticClass:"card"},[e("div",{staticClass:"title"},[e("span",{staticClass:"split",class:{show:s.status==s.TRANSACTING_ORDER_STATUS.HANGING&&void 0!==s.orderInfo.isSplit}},[s.status==s.TRANSACTING_ORDER_STATUS.HANGING&&void 0!==s.orderInfo.isSplit?[s._v(" "+s._s(s.orderInfo.isSplit?"可拆分":"不可拆分")+" ")]:s._e()],2),e("span",{staticClass:"status",class:s._f("transactingOrderStatus")(s.status)},[s._v(" "+s._s(s._f("transactingOrderStatus")(s.status,"seller-content"))+" ")]),e("span",{staticClass:"btn",class:{loading:s.loading},on:{click:function(){return s.loadDetails(s.orderInfo.orderId)}}},[e("van-icon",{attrs:{name:"replay"}})],1)]),e("div",{staticClass:"time"},[s.status==s.TRANSACTING_ORDER_STATUS.HANGING?[s._v(" 创建时间 "+s._s(s._f("dateFormat")(s.orderInfo.createTime,"Y/M/D h:m:s"))+" ")]:s._e(),s.status==s.TRANSACTING_ORDER_STATUS.BUYER_REQUEST?[e("span",{staticStyle:{color:"red"}},[s._v(" "+s._s(s.$root.waitingSellerConfirmOrderStr)+" ")]),s._v(" 内未操作系统将默认卖家取消交易 ")]:s._e(),s.status==s.TRANSACTING_ORDER_STATUS.WAITING_FOR_TRANSFER?[s._v(" 买家 "),e("span",{staticStyle:{color:"red"}},[s._v(" "+s._s(s.$root.buyerPayingTimeOverStr)+" ")]),s._v(" 内未操作,系统将默认买家取消交易 ")]:s._e(),s.status==s.TRANSACTING_ORDER_STATUS.TRANSFERRED?[e("span",{staticStyle:{color:"red"}},[s._v(" "+s._s(s.$root.waitingSellerCompleteOrderStr)+" ")]),s._v(" 内未操作，默认交易成功，将转币给买家 ")]:s._e(),s.status==s.TRANSACTING_ORDER_STATUS.DISPUTING?[s._v(" 争议订单将由官方客服介入协助处理 ")]:[s._v("  ")]],2),e("div",{staticClass:"orderId"},[s._v(" 挂单编号 "+s._s(s.orderInfo.pendingOrderNo)+" "),e("button",{directives:[{name:"clipboard",rawName:"v-clipboard",value:s.orderInfo.pendingOrderNo||"",expression:"orderInfo.pendingOrderNo || ''"}],staticClass:"copy copyBtn",on:{success:s.$root.copySuccessful}})])])]),e("van-cell",{staticClass:"kv amount",attrs:{title:"购买数量"}},[s._v(" V币 "+s._s(parseFloat(s.orderInfo.amount).toFixed(2))+" ")]),e("van-cell",{staticClass:"kv payment",attrs:{title:"收款方式"}},[s.PAYMENT_METHOD.BANK===s.orderInfo.paymentType?e("div",{staticClass:"payment-icon bank"}):s._e(),s.PAYMENT_METHOD.ALI===s.orderInfo.paymentType?e("div",{staticClass:"payment-icon ali"}):s._e(),s.PAYMENT_METHOD.WE_CHAT===s.orderInfo.paymentType?e("div",{staticClass:"payment-icon wechat"}):s._e()]),s.STEP[s.status]>0?e("van-cell-group",{attrs:{border:!1,title:"交易进度"},scopedSlots:s._u([{key:"title",fn:function(){return[e("span",{staticClass:"title"},[s._v("交易进度")]),s.status==s.TRANSACTING_ORDER_STATUS.BUYER_REQUEST||s.status==s.TRANSACTING_ORDER_STATUS.WAITING_FOR_TRANSFER||s.status==s.TRANSACTING_ORDER_STATUS.TRANSFERRED?e("span",{staticClass:"countdown"},[s._v(" 订单倒计时 "),e("van-count-down",{attrs:{time:s.countdown},on:{finish:s.onCountdownFinish}})],1):s._e()]},proxy:!0}],null,!1,3155898464)},[e("van-steps",{attrs:{active:s.stepsActive}},[e("van-step",[s._v(" "+s._s(s._f("dateFormat")(s.orderInfo.createTime,"M-D"))+" "),s.STEP[s.status]>=1?e("div",{staticClass:"bottom-status time"},[s._v(" "+s._s(s._f("dateFormat")(s.orderInfo.createTime,"h:m:s"))+" ")]):s._e()]),e("van-step",[s._v(" 卖家确认交易 "),s.STEP[s.status]>=1?e("div",{staticClass:"bottom-status",class:s._f("transactingOrderStatus")(s.status,void 0,1)},[s._v(" "+s._s(s._f("transactingOrderStatus")(s.status,"step",1))+" ")]):s._e()]),e("van-step",[s._v(" 买家转账 "),s.STEP[s.status]>=2?e("div",{staticClass:"bottom-status",class:(t={},t["time-over"]=s.isTimeoutDisputing,t[s.transactingOrderStatus(s.status,void 0,2)]=!0,t)},[s.isTimeoutDisputing?[s._v(" 超时取消")]:[s._v(" "+s._s(s._f("transactingOrderStatus")(s.status,"step",2))+" ")]],2):s._e()]),e("van-step",[s._v(" 交易完成 "),s.STEP[s.status]>=3?e("div",{staticClass:"bottom-status",class:s._f("transactingOrderStatus")(s.status)},[s._v(" "+s._s(s._f("transactingOrderStatus")(s.status,"step"))+" ")]):s._e()])],1)],1):s._e(),s.isSystemBuyer&&s.STEP[s.status]>=2?[e("div",{staticClass:"merchant"},[e("div",{staticClass:"title"},[s._v("买方付款信息")]),e("div",{staticClass:"description"},[s._v(" 该用户为平台认证用户，付款信息暂不展示，请卖家查询到款后 放心确认转币 ")]),e("div",{staticClass:"certificated"}),e("div",{staticClass:"certification"}),e(s.componentsMapping[s.radio],{tag:"components",staticClass:"paymentInfo",attrs:{hide:s.hide,payment:s.hide?void 0:s.sellerPayment,title:"卖方收款信息"}}),s._m(0)],1)]:[e(s.componentsMapping[s.radio],{tag:"components",attrs:{hide:s.hide,payment:s.hide?void 0:s.buyerPayment,title:"买方付款信息"}}),s.status==s.TRANSACTING_ORDER_STATUS.BUYER_REQUEST?[e("div",{staticClass:"gray-8"}),e("div",{staticClass:"seller-credit-indicator"},[e("div",{staticClass:"title"},[s._v("买方信用资讯")]),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[e("div",{staticClass:"label"},[s._v(s._s(s.buyerOrderIndicator.range)+"日成单数")]),e("div",{staticClass:"value"},[e("span",{staticClass:"bold"},[s._v(" "+s._s(s.buyerOrderIndicator.totalSuccessfulOrder)+" ")])])]),e("div",{staticClass:"col"},[e("div",{staticClass:"label"},[s._v(s._s(s.buyerOrderIndicator.range)+"日成单率")]),e("div",{staticClass:"value"},[e("span",{staticClass:"bold"},[s._v(" "+s._s(s.buyerOrderIndicator.totalSuccessRate)+"% ")])])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[e("div",{staticClass:"label"},[s._v(" "+s._s(s.buyerOrderIndicator.range)+"日平均放币时间 ")]),e("div",{staticClass:"value"},[s._v(" < "),e("span",{staticClass:"bold"},[s._v(" "+s._s(s.buyerOrderIndicator.sellerAvgTime)+" ")]),s._v(" 分钟 ")])]),e("div",{staticClass:"col"},[e("div",{staticClass:"label"},[s._v(" "+s._s(s.buyerOrderIndicator.range)+"日平均付款时间 ")]),e("div",{staticClass:"value"},[s._v(" < "),e("span",{staticClass:"bold"},[s._v(" "+s._s(s.buyerOrderIndicator.buyerAvgTime)+" ")]),s._v(" 分钟 ")])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[e("div",{staticClass:"label"},[s._v("买单")]),e("div",{staticClass:"value"},[e("span",{staticClass:"bold"},[s._v(" "+s._s(s.buyerOrderIndicator.buyerOrder)+" ")]),s._v(" 笔 ")])]),e("div",{staticClass:"col"},[e("div",{staticClass:"label"},[s._v("卖单")]),e("div",{staticClass:"value"},[e("span",{staticClass:"bold"},[s._v(" "+s._s(s.buyerOrderIndicator.sellerOrder)+" ")]),s._v(" 笔 ")])])])])]:e(s.componentsMapping[s.radio],{tag:"components",attrs:{hide:s.hide,payment:s.hide?void 0:s.sellerPayment,title:"卖方收款信息"}}),s.status==s.TRANSACTING_ORDER_STATUS.TRANSFERRED||s.status==s.TRANSACTING_ORDER_STATUS.SELLER_DID_NOT_RECEIVE&&!s.isCountdownEnd||s.status==s.TRANSACTING_ORDER_STATUS.DISPUTING?[e("van-image",{staticClass:"certificationImage",attrs:{src:s.$root.getImageUrl(s.orderInfo.voucher),fit:"contain"},on:{click:function(t){s.previewImage(s.$root.getImageUrl(s.orderInfo.voucher))}}})]:s._e(),s.status==s.TRANSACTING_ORDER_STATUS.WAITING_FOR_TRANSFER||s.status==s.TRANSACTING_ORDER_STATUS.TRANSFERRED?[e("div",{staticClass:"warning"},[s._v(" 1.请认真核对买方付款信息，如「到款信息与买方付款信息不一 致」或「未收到付款」千万不要放行您的数字货币，一旦确认我 已收到款 ")]),e("div",{staticClass:"warning"},[s._v("2.收到买方真实付款后点击「确认转币」")])]:s._e()],e("div",{staticClass:"btns"},[s.status==s.TRANSACTING_ORDER_STATUS.BUYER_REQUEST?[e("van-button",{staticClass:"danger block",on:{click:s.cancel_transaction}},[s._v(" 取消交易 ")]),e("van-button",{staticClass:"primary block",on:{click:s.start_transaction}},[s._v(" 开始交易 ")])]:s._e(),s.status==s.TRANSACTING_ORDER_STATUS.WAITING_FOR_TRANSFER||s.status==s.TRANSACTING_ORDER_STATUS.TRANSFERRED?[e("van-button",{staticClass:"danger block",class:{disabled:s.status!=s.TRANSACTING_ORDER_STATUS.TRANSFERRED},on:{click:s.did_not_received}},[s._v(" 未收到转账 ")]),e("van-button",{staticClass:"primary block",class:{disabled:s.status!=s.TRANSACTING_ORDER_STATUS.TRANSFERRED},on:{click:s.confirm_transfer}},[s._v(" 确认转币 ")])]:s._e(),s.status==s.TRANSACTING_ORDER_STATUS.DISPUTING?[e("van-button",{staticClass:"primary block",on:{click:s.$root.openCustomerService}},[s._v(" 联系客服 ")])]:s._e()],2),e("van-dialog",{staticClass:"applyDialog",attrs:{"confirm-button-color":"#6F59FE","confirm-button-text":"提交申诉","show-cancel-button":"",title:"请简要描述您的申诉内容"},model:{value:s.show_apply,callback:function(t){s.show_apply=t},expression:"show_apply"}},[e("van-field",{attrs:{autocomplete:"new-password",autosize:"",maxlength:"50",placeholder:"0/50",rows:"3","show-word-limit":"",type:"textarea"},model:{value:s.applyReason,callback:function(t){s.applyReason=t},expression:"applyReason"}})],1),e("van-dialog",{staticClass:"applyDialog",class:{disabled:!s.enable_receive_transfer_dialog},attrs:{"confirm-button-color":"#6f59fe","confirm-button-text":s.enable_receive_transfer_dialog?"是":s.countdown_time+"s","cancel-button-text":"否","show-cancel-button":"",title:"重要提醒","before-close":s.confirmed_transfer},on:{close:function(t){s.enable_receive_transfer_dialog=!1}},model:{value:s.show_receive_transfer_confirm,callback:function(t){s.show_receive_transfer_confirm=t},expression:"show_receive_transfer_confirm"}},[s._v(" 请仔细核对您的收款账户"),e("span",{staticStyle:{color:"#FB2222","font-weight":"bold"}},[s._v("「是否收到款」")]),s._v("， "),e("span",{staticStyle:{color:"#FB2222","font-weight":"bold"}},[s._v("「收款金额」")]),s._v("是否与您的卖币金额一致 "),s.show_receive_transfer_confirm?e("van-count-down",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{time:"5000",format:"ss"},on:{finish:s.countdownFinish,change:s.countdownChange}}):s._e()],1)],2)},i=[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{staticClass:"riskDescription gray-8"},[a("div",{staticClass:"title"},[t._v("VipPay风控")]),a("div",[t._v(" 1、为了降低您的交易风险，认证用户已向平台缴纳保证金，请放心 交易。 ")]),a("div",[t._v(" 2、平台认证用户，由平台担保交易资金安全性，如出现资金问题由 平台方全额赔付。 ")])])}],n=a(23796),r=a(75628),o=a(51688),c=a(16116),l=a(21380),d=a(32277),_={components:{BankPaymentInfo:c.JF,WechatPaymentInfo:c.Ey,AliPaymentInfo:c.q$},data:function(){var t;return{PAYMENT_METHOD:r.hL,STATUS_TYPE:r.Z2,STEP:r.g0,TRANSACTING_ORDER_STATUS:r.eD,status:r.eD.HANGING,countdown:1,isTimeOut:!1,show_apply:!1,applyReason:"",loading:!1,radio:"",orderInfo:{},buyerPayment:{},sellerPayment:{},buyerOrderIndicator:{},componentsMapping:(t={},(0,n.Z)(t,r.hL.BANK,"BankPaymentInfo"),(0,n.Z)(t,r.hL.ALI,"AliPaymentInfo"),(0,n.Z)(t,r.hL.WE_CHAT,"WechatPaymentInfo"),t),show_receive_transfer_confirm:!1,enable_receive_transfer_dialog:!1,countdown_time:0}},computed:{hide:function(){return!(this.status===this.TRANSACTING_ORDER_STATUS.TRANSFERRED&&!this.isCountdownEnd||this.status===this.TRANSACTING_ORDER_STATUS.DISPUTING)},isCountdownEnd:function(){return this.countdown<=0},stepsActive:function(){return this.STEP[this.status]},isTimeoutDisputing:function(){return!(this.status!=this.TRANSACTING_ORDER_STATUS.DISPUTING||!this.isTimeOut)},payments:function(){return this.$root.parsePayments(this.orderInfo.paymentType)},isSystemBuyer:function(){return"System"===this.orderInfo.buyerType}},created:function(){this.load(),this.$root.$emit("root:set-topbar",["left-back","customer-service"])},beforeDestroy:function(){clearTimeout(this.timer)},methods:{transactingOrderStatus:function(){var t;return(t=this.$options.filters).transactingOrderStatus.apply(t,arguments)},start_transaction:function(){var t=this;(0,o.H9)().then((function(){(0,l.N8)({orderId:t.$route.params.id}).then((function(s){var a=s.ok,e=s.msg;a?(t.$toast.success(e),t.status=r.eD.WAITING_FOR_TRANSFER,t.load()):t.$toast.fail(e)}))}))},cancel_transaction:function(){var t=this;(0,l.y6)().then((function(s){var a=s.ok,e=s.data,i=s.msg;a?(0,o.VN)(e.allowedCancelsOrderDailyCount-e.cancelsOrderDailyCount,e.allowedCancelsOrderDailyCount).then((function(){(0,l.CI)({orderId:t.$route.params.id}).then((function(s){var a=s.ok,e=s.msg;a?(t.$toast.success(e),t.status=r.eD.SELLER_CANCELED_DEAL,t.load()):t.$toast.fail(e)}))})):t.$toast.fail(i)}))},did_not_received:function(){var t=this;(0,o.EQ)().then((function(){(0,l.Ej)({orderId:t.$route.params.id}).then((function(s){var a=s.ok,e=s.msg;a?(t.$toast.success(e),t.status=r.eD.SELLER_DID_NOT_RECEIVE,t.load()):t.$toast.fail(e)}))}))},confirmed_transfer:function(t,s){var a=this;s(),"confirm"===t&&(0,l.XW)({orderId:this.$route.params.id}).then((function(t){var s=t.ok,e=t.msg;s?(a.$toast.success(e),a.status=r.eD.DEAL,a.load()):a.$toast.fail(e)}))},countdownChange:function(t){this.countdown_time=t.seconds},countdownFinish:function(){this.enable_receive_transfer_dialog=!0},confirm_transfer:function(){this.show_receive_transfer_confirm=!0},load:function(){this.loadDetails(this.$route.params.id)},loadDetails:function(t){var s=this;this.loading||(this.loading=!0,(0,l.fW)({orderId:t}).then((function(t){var a=t.ok,e=t.msg,i=t.data;s.loading=!1,a?(clearTimeout(s.timer),s.orderInfo=i.order,s.sellerPayment=i.sellerPayment,s.buyerPayment=i.buyerPayment,s.radio=i.order.paymentType,s.buyerOrderIndicator=i.buyerOrderIndicator,s.orderInfo.appeal>0?(s.status=r.eD.DISPUTING,s.orderInfo.status===r.eD.TIME_OVER&&(s.isTimeOut=!0)):s.status=s.orderInfo.status,i.currentStateExpireTime&&(i.currentStateExpireTime.expire?s.countdown=1e3*i.currentStateExpireTime.expire-s.$root.getServerTime():s.countdown=0),s.refreshStatus()):s.$toast.fail(e)})))},refreshStatus:function(){var t=this;this.timer=setTimeout((function(){(0,l.dF)({orderId:t.$route.params.id}).then((function(s){var a=s.ok,e=s.data;if(t.refreshStatus(),a){var i=t.status;t.orderInfo.appeal>0?(t.status=r.eD.DISPUTING,e.status===r.eD.TIME_OVER&&(t.isTimeOut=!0)):t.status=e.status,t.status!==i&&t.loadDetails(t.orderInfo.orderId)}}))}),1e4)},onCountdownFinish:function(){this.load()},previewImage:function(t){(0,d.Z)([t])}}},u=_,v=a(1001),T=(0,v.Z)(u,e,i,!1,null,null,null),f=T.exports}}]);