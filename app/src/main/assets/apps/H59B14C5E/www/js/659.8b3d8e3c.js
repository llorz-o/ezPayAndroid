"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[659],{87659:function(t,r,e){e.r(r),e.d(r,{default:function(){return d}});var n=function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("div",{staticClass:"page page-sale"},[e("div",{staticClass:"top-wrapper"},[e("div",{staticClass:"merchant"},[e("div",{staticClass:"left"},[e("van-image",{staticClass:"avatar",attrs:{src:t.$root.getImageUrl(t.$root.userInfo.avatar),round:"",fit:"cover"}}),e("div",{staticClass:"name"},[t._v(t._s(t.$root.userInfo.nickname))])],1),e("div",{staticClass:"right"},[e("div",{staticClass:"label"},[t._v("可出售总额（V币）")]),e("div",{staticClass:"amount"},[t._v(" "+t._s(parseFloat(t.$root.userInfo.balance).toFixed(2))+" ")])])])]),e("van-form",{on:{submit:t.handlerSubmit}},[e("van-field",{attrs:{autocomplete:t.$root.getHash(),type:"number",label:"出售数量：",placeholder:"最低出售数量为10/V币"},model:{value:t.form.amount,callback:function(r){t.$set(t.form,"amount",r)},expression:"form.amount"}}),t.form.isSplit?e("van-field",{attrs:{autocomplete:t.$root.getHash(),type:"number",label:"最低购买：",placeholder:"请填写买家最低可购买数量"},model:{value:t.form.minBuyEach,callback:function(r){t.$set(t.form,"minBuyEach",r)},expression:"form.minBuyEach"}}):t._e(),e("van-collapse",{model:{value:t.form.paymentType,callback:function(r){t.$set(t.form,"paymentType",r)},expression:"form.paymentType"}},[e("van-checkbox-group",{model:{value:t.form.paymentType,callback:function(r){t.$set(t.form,"paymentType",r)},expression:"form.paymentType"}},[e("van-cell-group",{attrs:{title:"请选择收款方式"}},t._l(t.$root.payments,(function(r,n){return e("van-collapse-item",{key:n,staticClass:"payment",attrs:{title:0===r.list.length?"未绑定该收款方式":r.typeName,name:r.type,clickable:"",disabled:0===r.list.length},scopedSlots:t._u([{key:"icon",fn:function(){return[e("div",{staticClass:"payment-icon",class:n})]},proxy:!0},{key:"right-icon",fn:function(){return[e("van-checkbox",{attrs:{name:r.type,disabled:0===r.list.length,shape:"square"}})]},proxy:!0}],null,!0)},[e("van-radio-group",{model:{value:t.form.payments[n],callback:function(r){t.$set(t.form.payments,n,r)},expression:"form.payments[k]"}},t._l(r.list,(function(a,o){return e("van-cell",{key:o,staticClass:"paymentChannel",attrs:{title:r.type===t.PAYMENT_METHOD.BANK?t.$root.banksIdMappingName[a.bankId]:"账号:"+a.account,value:(a.bankNo||"").replace(/\d{4}/g,(function(t){return t+" "})),clickable:""},on:{click:function(r){t.form.payments[n]=a.id}},scopedSlots:t._u([{key:"right-icon",fn:function(){return[e("van-radio",{attrs:{name:a.id}})]},proxy:!0}],null,!0)})})),1)],1)})),1)],1)],1),e("van-cell-group",{staticClass:"split",attrs:{title:"是否拆分",border:!1}},[e("van-radio-group",{model:{value:t.form.isSplit,callback:function(r){t.$set(t.form,"isSplit",r)},expression:"form.isSplit"}},[e("van-radio",{staticClass:"btn",attrs:{name:1}},[e("div",{staticClass:"btn",attrs:{slot:"icon"},slot:"icon"},[t._v("可拆分")])]),e("van-radio",{staticClass:"btn",attrs:{name:0}},[e("div",{staticClass:"btn",attrs:{slot:"icon"},slot:"icon"},[t._v("不可拆分")])])],1)],1),e("van-button",{staticClass:"block primary",attrs:{"native-type":"submit"}},[t._v(" 发布挂单 ")])],1)],1)},a=[],o=e(75200),i=e(62032),s=(e(41539),e(70189),e(78783),e(33948),e(54747),e(47941),e(39714),e(69600),e(57327),e(21249),e(69720),e(9653),e(75628)),u=e(21380),l={data:function(){return{PAYMENT_METHOD:s.hL,collapse:"",form:{amount:"",minBuyEach:"",paymentType:[],isSplit:1,payments:{}}}},computed:{paymentsMappingIds:function(){var t={};for(var r in this.$root.payments){var e=this.$root.payments[r];t[e.type]=e.list}return t}},watch:{"form.paymentType":function(t,r){var e,n=new Set(r),a=(0,i.Z)(t);try{for(a.s();!(e=a.n()).done;){var o=e.value;if(!n.has(o)){this.form.payments[o===s.hL.BANK?"bank":o===s.hL.ALI?"ali":"wechat"]=this.paymentsMappingIds[o][0].id;break}}}catch(f){a.e(f)}finally{a.f()}var u,l=new Set(t),c=(0,i.Z)(r);try{for(c.s();!(u=c.n()).done;){var m=u.value;if(!l.has(m)){this.form.payments[m===s.hL.BANK?"bank":m===s.hL.ALI?"ali":"wechat"]="";break}}}catch(f){c.e(f)}finally{c.f()}},"form.isSplit":function(){this.form.minBuyEach=""}},created:function(){this.loadPayments(),this.$root.$emit("root:set-topbar",["left-back","customer-service"])},methods:{loadPayments:function(){var t=this;this.$root.loadPayments().then((function(r){var e=r.ok;e&&Object.keys(t.$root.payments).forEach((function(r){t.$set(t.form.payments,r,"")}))}))},handlerSubmit:function(){var t=this,r=Object.entries(this.form.payments).map((function(t){var r=(0,o.Z)(t,2),e=(r[0],r[1]);return e})).filter((function(t){return t>0})).join(",").toString();if(this.form.amount<10)return this.$toast.fail("最低出售量为10");if(!r.length)return this.$toast.fail("请选择支付方式");var e=!0;return this.form.paymentType.forEach((function(r){return r===s.hL.BANK&&0===t.$root.payments.bank.list.length||r===s.hL.ALI&&0===t.$root.payments.ali.list.length||r===s.hL.WE_CHAT&&0===t.$root.payments.wechat.list.length?t.paymentVerifyFlag=!1:void 0})),e?this.form.isSplit&&!this.form.minBuyEach?this.$toast.fail("请输入最低购买数量"):this.form.isSplit&&this.form.minBuyEach.toNumber()>this.form.amount.toNumber()?this.$toast.fail("最低购买量不得高于出售量"):(this.$root.$emit("root:open-global-password"),void this.$root.$once("root:global-password",(function(e){e&&(0,u.v1)(t.$tls.processParams({amount:Number(t.form.amount),minBuyEach:Number(t.form.minBuyEach),paymentType:t.form.paymentType.reduce((function(t,r){return t+r}),0).toString(),paymentTypeId:r,isSplit:t.form.isSplit.toString(),maxBuyEach:Number(t.form.amount),sign:"",securePassword:e},["float","shake"])).then((function(r){var e=r.ok,n=(r.data,r.msg);e?(t.$root.fetchUserInfo(),t.$router.push("my_hang_orders")):t.$toast.fail(n)}))}))):this.$toast.fail("请选择支付账户")}}},c=l,m=e(1001),f=(0,m.Z)(c,n,a,!1,null,null,null),d=f.exports},21380:function(t,r,e){e.d(r,{$Z:function(){return u},$i:function(){return s},CI:function(){return h},Ej:function(){return v},Hn:function(){return c},N8:function(){return y},R9:function(){return g},T7:function(){return $},XW:function(){return b},_H:function(){return a},_d:function(){return k},an:function(){return d},cf:function(){return f},dF:function(){return m},fW:function(){return l},l$:function(){return O},uF:function(){return o},v1:function(){return i},vi:function(){return p},y6:function(){return T}});var n=e(51922),a=function(t){return(0,n.q)({url:"/Api/Market/PendingOrder/marketPendingOrderList",method:"POST",data:t})},o=function(t){return(0,n.q)({url:"/Api/Market/Order/myOrderList",method:"GET",data:t})},i=function(t){return(0,n.q)({url:"/Api/Market/Sell/index",method:"POST",data:t})},s=function(t){return(0,n.q)({url:"/Api/Market/Sell/recycle",method:"POST",data:t})},u=function(t){return(0,n.q)({url:"Api/Market/PendingOrder/myPendingOrderList",method:"POST",data:t})},l=function(t){return(0,n.q)({url:"/Api/Market/Order/myOrderDetail",method:"GET",data:t})},c=function(t){return(0,n.q)({url:"/Api/Market/PendingOrder/marketPendingOrderDetail",method:"POST",data:t})},m=function(t){return(0,n.q)({url:"/Api/Market/Order/getCurrentOrderStatus",method:"GET",data:t})},f=function(t){return(0,n.q)({url:"/Api/Market/PendingOrder/myPendingOrderDetail",method:"GET",data:t})},d=function(t){return(0,n.q)({url:"/Api/Market/Order/buyerCreatesOrder",method:"POST",data:t})},p=function(t){return(0,n.q)({url:"/Api/Market/PendingOrder/getOrderListByPendingOrder",method:"GET",data:t})},h=function(t){return(0,n.q)({url:"/Api/Market/Order/sellerRefusesToCreateOrder",method:"POST",data:t})},y=function(t){return(0,n.q)({url:"/Api/Market/Order/sellerConfirmsToCreateOrder",method:"POST",data:t})},v=function(t){return(0,n.q)({url:"/Api/Market/Order/sellerHasNotReceivedPayment",method:"POST",data:t})},b=function(t){return(0,n.q)({url:"/Api/Market/Order/sellerCompletesOrder",method:"POST",data:t})},k=function(t){return(0,n.q)({url:"/Api/Market/Order/buyerCancelsOrder",method:"POST",data:t})},O=function(t){return(0,n.q)({url:"/Api/Market/Order/buyerConfirmsOrderHasBeenPaid",method:"POST",data:t})},g=function(t){return(0,n.q)({url:"/Api/Market/Order/buyerAppeals",method:"POST",data:t})},T=function(t){return(0,n.q)({url:"/Api/Market/Order/getCancelsOrderDailyCount",method:"GET",data:t})},$=function(t){return(0,n.q)({url:"/Api/User/TransferOrder/userDeposit",method:"POST",data:t})}},62032:function(t,r,e){e.d(r,{Z:function(){return a}});e(82526),e(41817),e(41539),e(32165),e(78783),e(33948),e(21703);var n=e(48936);function a(t,r){var e="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=(0,n.Z)(t))||r&&t&&"number"===typeof t.length){e&&(t=e);var a=0,o=function(){};return{s:o,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return s=t.done,t},e:function(t){u=!0,i=t},f:function(){try{s||null==e["return"]||e["return"]()}finally{if(u)throw i}}}}}}]);