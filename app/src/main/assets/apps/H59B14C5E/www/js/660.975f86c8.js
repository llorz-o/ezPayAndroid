"use strict";(self["webpackChunkez_pay"]=self["webpackChunkez_pay"]||[]).push([[660],{3660:function(o,e,t){t.r(e),t.d(e,{default:function(){return u}});var s=function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("div",{staticClass:"page-login"},[t("van-form",{on:{submit:o.onSubmit}},[t("van-field",{attrs:{autocomplete:o.$root.getHash(),placeholder:"手机号","left-icon":"phone",type:"tel",maxlength:"11"},model:{value:o.form.phoneNumber,callback:function(e){o.$set(o.form,"phoneNumber",e)},expression:"form.phoneNumber"}}),t("van-field",{attrs:{autocomplete:o.$root.getHash(),placeholder:"密码","left-icon":"lock",type:o.showPassword?"text":"password","right-icon":o.showPassword?"eye-o":"closed-eye"},on:{"click-right-icon":function(e){o.showPassword=!o.showPassword}},model:{value:o.form.password,callback:function(e){o.$set(o.form,"password",e)},expression:"form.password"}}),t("van-field",{attrs:{autocomplete:o.$root.getHash(),placeholder:"验证码","left-icon":"youzan-shield"},scopedSlots:o._u([{key:"extra",fn:function(){return[t("van-image",{staticClass:"verifyCode",attrs:{src:o.verifyImageBase64},on:{click:o.refreshImageVerifyCode}})]},proxy:!0}]),model:{value:o.form.imgCode,callback:function(e){o.$set(o.form,"imgCode",e)},expression:"form.imgCode"}}),o.unbind?t("van-field",{attrs:{autocomplete:o.$root.getHash(),placeholder:"短信验证码","left-icon":"youzan-shield"},scopedSlots:o._u([{key:"extra",fn:function(){return[t("van-button",{staticClass:"btnGetVerifyCode primary",attrs:{size:"small","native-type":"button"},on:{click:o.getSmsVerifyCode}},[o.smsCountdown?t("van-count-down",{attrs:{time:o.smsCountdown,format:"SS","auto-start":""},on:{finish:function(e){o.smsCountdown=0}}}):[o._v(" 获取验证码 ")]],2)]},proxy:!0}],null,!1,1500168340),model:{value:o.form.smsCode,callback:function(e){o.$set(o.form,"smsCode",e)},expression:"form.smsCode"}}):o._e(),o.unbind?[t("van-button",{staticClass:"primary block unbind"},[o._v(" 确认登陆 ")])]:[t("div",{staticClass:"ver"},[o._v("版本号：V "+o._s(o.$root.version))]),t("van-button",{staticClass:"primary block"},[o._v(" 登录 ")]),t("div",{staticClass:"forgotPassword",on:{click:o.onForgotPsw}},[o._v("忘记密码？")])]],2)],1)},r=[],i=t(3652),n=t(9248),a=t(1922),d={data(){return{form:{phoneNumber:"",password:"",imgCode:"",phoneNumber:""},verifyImageBase64:"",showPassword:!1,smsCountdown:0,verifyUniqid:""}},computed:{unbind(){return 1==this.$route.query.unbind}},created(){this.refreshImageVerifyCode()},methods:{onSubmit(){return/^1[345789]\d{9}$/.test(this.form.phoneNumber)?!/^(?![^a-zA-Z]+$)(?!\D+$)/.test(this.form.password)||this.form.password.length<6||this.form.password.length>15?this.$toast.fail("请输入6-15位字母数字组成的密码"):this.unbind?""==this.form.smsCode?this.$toast.fail("请输入短信验证码"):void(0,i.rd)({phoneNumber:this.form.phoneNumber,password:this.form.password,code:this.form.imgCode,verifyUniqid:this.verifyUniqid,smsCode:this.form.smsCode}).then((({ok:o,data:e,msg:t})=>{o?(this.$root.userInfo=e.userInfo,this.$st.set("USER_INFO",e.userInfo),this.$st.set("TOKEN",e.token),(0,a.Ks)(e.token),this.$root.loadConfig(),this.$root.loadBanks(),this.$router.replace("/")):(this.refreshImageVerifyCode(),this.form.smsCode="",this.form.imgCode="",this.$toast.fail(t))})):void(0,i.x4)({phoneNumber:this.form.phoneNumber,password:this.form.password,code:this.form.imgCode,verifyUniqid:this.verifyUniqid}).then((({ok:o,data:e,msg:t,code:s})=>{if(1001===s)return this.$router.push("/qr_login");o?(this.$root.userInfo=e.userInfo,this.$st.set("USER_INFO",e.userInfo),this.$st.set("TOKEN",e.token),(0,a.Ks)(e.token),this.$root.loadConfig(),this.$root.loadBanks(),this.$router.replace("/")):(this.refreshImageVerifyCode(),this.form.imgCode="",this.$toast.fail(t))})):this.$toast.fail("请输入合法的手机号码")},refreshImageVerifyCode(){(0,n.mg)({codeType:"login"}).then((({ok:o,data:e,code:t})=>{if(o)this.verifyUniqid=e.verifyUniqid,this.verifyImageBase64=e.verifyCode;else if(400==t)return this.$toast.fail("请输入合法的手机号码")}))},smsCount(){const o=this.$st.get("LAST_SMS_REQUEST");if(o){const e=Date.now()-Number(o);e<60&&(this.smsCountdown=1e3*(60-e))}},getSmsVerifyCode(){this.smsCountdown||(0,n.Z3)({phoneNumber:this.form.phoneNumber,codeType:"register"}).then((({ok:o,msg:e,data:t})=>{o?(this.$toast.success(e),this.smsCountdown=6e4,this.$st.set("LAST_SMS_REQUEST",Date.now())):this.$toast.fail(e)}))},onForgotPsw(){this.$dialog.confirm({className:"retrievePsw",message:"找回密码,请联系客服",confirmButtonColor:"#6f59fe",confirmButtonText:"确认",cancelButtonText:"取消",beforeClose:(o,e)=>{"confirm"===o&&this.$root.openCustomerService(),e()}})}}},m=d,f=t(1001),h=(0,f.Z)(m,s,r,!1,null,null,null),u=h.exports},9248:function(o,e,t){t.d(e,{Z3:function(){return n},mg:function(){return r},pw:function(){return i}});var s=t(1922);const r=o=>(0,s.q)({url:"/Api/Common/VerifyCode/getImageCode",method:"POST",data:o}),i=o=>(0,s.q)({url:"/Api/Common/VerifyCode/checkVerifyCode",method:"POST",data:o}),n=o=>(0,s.q)({url:"/Api/Common/VerifyCode/sendCode",method:"POST",data:o})}}]);